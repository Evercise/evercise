function redirectTo(i){window.location.href=i.url}function editClass(i){$("#"+i.id).html(i.view),$("#edit-"+i.id).removeClass("disabled"),$("#submit-"+i.id).hide(),$("#"+i.id).parent().collapse("show"),$("#infoToggle-"+i.id).removeClass("hide"),datepick()}function updateHubRow(i){$("#hub-edit-row-"+i.id).after(i.view)}function newSessionAdded(i){$("#"+i.id).html(i.view),datepick()}function removeSessionRow(i){$("#hub-edit-row-"+i.id).fadeOut(400)}
if("undefined"!=typeof angular){var app=angular.module("everApp",["ng.deviceDetector","google-maps".ns()],["$interpolateProvider",function(r){r.startSymbol("{[{"),r.endSymbol("}]}")}]);app.config(["GoogleMapApiProvider".ns(),function(r){r.configure({v:"3.17",libraries:"places",uk:!0})}]),app.filter("truncate",function(){return function(r,n,e){return isNaN(n)&&(n=10),void 0===e&&(e="..."),r.length<=n||r.length-e.length<=n?r:String(r).substring(0,n-e.length)+e}}),app.filter("repeat",function(){return function(r,n){n=parseInt(n);for(var e=0;n>e;e++)r.push(e);return r}}),app.directive("errSrc",function(){return{link:function(r,n,e){n.bind("error",function(){e.src!=e.errSrc&&e.$set("src",e.errSrc)})}}})}
function datepick(){$(".date-picker").datepicker({format:"yyyy-mm-dd",startDate:"+2d",autoclose:!0,todayHighlight:!0})}$.fn.exists=function(t){var a=[].slice.call(arguments,1);return this.length&&t.call(this,a),this};
$.ajaxSetup({headers:{"X-CSRF-Token":TOKEN}}),$(function(){$(".navbar").exists(function(){new Navigation(this,$(".hero-nav-change"))}),$(".masonry").exists(function(){new Masonry(this)}),$(".toggle-switch").exists(function(){$(document).on("click",".toggle-switch",function(e){new ToggleSwitch($(e.target))})}),$(".map_canvas").exists(function(){map=new Map(this)}),$(".lazy").exists(function(){$("img.lazy").lazyload()}),$(".mb-scroll").exists(function(){$(this).mCustomScrollbar({scrollSpeed:50,mouseWheelPixels:50,autoHideScrollbar:!1,scrollInertia:0})}),$(".holder").exists(function(){new ImagePlaceholder}),$("#register-form").exists(function(){new registerUser(this)}),$("#register-trainer").exists(function(){new registerTrainer(this)}),$(".class-preview").exists(function(){new PreviewClassBox(this)}),$(".hide-by-class").exists(function(){var e=0;$(".hide-by-class").each(function(){var s=this;$("."+$(this).attr("href").substr(1)).exists(function(){0==e&&($(s).addClass("active"),$(s).parent().removeClass("hidden-mob"),$(this).removeClass("hide")),$(s).removeClass("disabled"),e++})}),this.click(function(){$(".hide-by-class").removeClass("active"),$(this).addClass("active"),$(".hide-by-class-element").addClass("hide"),$("."+$(this).attr("href").substr(1)).removeClass("hide")})}),$(".login-form").exists(function(){new Login(this)}),$(".edit-class-inline").exists(function(){new EditClass(this),$(document).on("submit",".add-session",function(e){e.preventDefault(),new AjaxRequest($(e.target),newSessionAdded)})}),$(document).on("submit",".remove-session",function(e){e.preventDefault(),new AjaxRequest($(e.target),removeSessionRow)}),cart=new Cart(this),$("#find_gallery_image_by_category").exists(function(){new categorySelect($(this))}),$("#image-cropper").exists(function(){new imageCropper(this)}),$("#create-venue").exists(function(){new createVenue(this)}),$("#add-session").exists(function(){new AddSessionsToCalendar(this)}),$("#update-sessions").exists(function(){new UpdateSessions(this)}),$("#create-class").exists(function(){new createClass(this)}),$("#preview").exists(function(){new previewBox(this)}),$("#publish-class").exists(function(){new publishClass(this)}),$("#register-fb").exists(function(){new facebookRedirect(this)}),$("#scroll-to").exists(function(){new scrollTo(this)}),$("#profile-nav").exists(function(){new profileNav(this)}),$(".rate-it").exists(function(){new RateIt(this)}),$("#add-topup").exists(function(){new topUp(this)}),$("#location-auto-complete").exists(function(){autocomplete=new LocationAutoComplete(this)}),$("#checkout").exists(function(){new checkout(this)}),$("#voucher").exists(function(){new voucher(this)}),$("#refer-a-friend").exists(function(){new Referral(this)}),$("#update-user-form").exists(function(){new updateProfile(this)}),$("#list-accordion").exists(function(){new listAccordion(this)}),$("#hero-carousel , #image-carousel").exists(function(){$(this).carousel({interval:5e3})}),$(".mail-popup").exists(function(){new MailPopup(this)}),$("#withdraw-funds").exists(function(){new Withdrawal(this)}),$(".remove-session").exists(function(){new RemoveSession(this)}),$(".landing-popup").exists(function(){$(document).on("click",".close",function(){$(".landing-popup").addClass("hidden"),$(".landing-mask").addClass("hidden")})}),$("#passwords_reset").exists(function(){$(document).on("submit","#passwords_reset",function(e){e.preventDefault(),new AjaxRequest($(e.target),redirectTo)})}),$(".trapezium").exists(function(){new trapezium(this)}),$(".category-select").exists(function(){new categoryAutoComplete(this)}),navigator.geolocation&&new myLocation,$(".select-box").selectbox(),$(".sticky").exists(function(){var e=this,s=e.offset().top;$(window).scroll(function(){var t=$(this).scrollTop();t>=s?e.addClass("fixed"):e.removeClass("fixed")})}),$("#class-calendar").exists(function(){})});
var Validation=function(a){this.form=a,this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.displayName={message:"Your username is not valid",validators:{notEmpty:{message:"Your display name is required"},stringLength:{min:5,max:20,message:"Your display name must be more than 5 and less than 20 characters long"},regexp:{regexp:/^[a-zA-Z0-9_]+$/,message:"Your display name can only consist of alphabetical, number and underscore"}}},this.email={validators:{notEmpty:{message:"Your email is required and cannot be empty"},emailAddress:{message:"Your email is not a valid email address"}}},this.first_name={validators:{notEmpty:{message:"Your first name is required and cannot be empty"},stringLength:{min:2,max:15,message:"Your first name must be more than 2 and less than 15 characters long"}}},this.last_name={validators:{notEmpty:{message:"Your surname is required and cannot be empty"},stringLength:{min:2,max:15,message:"Your surname must be more than 2 and less than 15 characters long"}}},this.password={validators:{notEmpty:{message:"Your password is required and cannot be empty"},stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"confirmed_password",message:"Your passwords do not match"}}},this.confirmed_password={validators:{notEmpty:{message:"Your password is required and cannot be empty"},stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"password",message:"Your passwords do not match"}}},this.init()};Validation.prototype={constructor:Validation,init:function(){this.form.find("input[type='submit']").prop("disabled",!0),this.validation()},validation:function(){this.form.bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{display_name:this.displayName,email:this.email,first_name:this.first_name,last_name:this.last_name,password:this.password,confirmed_password:this.confirmed_password}}).on("success.form.bv",function(a){a.preventDefault(),new AjaxRequest($(a.target),redirectTo)})}};
var Navigation=function(o,s){this.nav=o,this.hero=s,this.height=o.height(),this.heroClass="nav-hero",this.scroll=0,this.init()};Navigation.prototype={constructor:Navigation,init:function(){this.hero.length>0&&this.addHeroClass()},addHeroClass:function(){this.nav.addClass(this.heroClass)},removeHeroClass:function(){this.nav.removeClass(this.heroClass)},checkScrollPosition:function(){var o=this;$(window).scroll(function(){o.scroll=$(window).scrollTop(),o.scroll+o.height>=o.hero.outerHeight()?o.removeHeroClass():o.addHeroClass()})}};
function imageCropper(i){this.elem=i,this.modal=this.elem.find(".modal-cropper"),this.modalImage=this.modal.find("#uploaded-image"),this.uploadForm=this.elem.find("#image-upload-form"),this.galleryRow=$("#gallery-row"),this.galleryImage="",this.galleryValue="",this.croppedForm=this.modal.find("#cropped-image"),this.uploadButton=this.modal.find("input[name='file']"),this.imageSelect=this.uploadForm.find(".image-select"),this.image=this.modal.find(".bootstrap-modal-cropper img"),this.xInput=this.modal.find("input[name='x']"),this.yInput=this.modal.find("input[name='y']"),this.wInput=this.modal.find("input[name='width']"),this.hInput=this.modal.find("input[name='height']"),this.bwInput=this.modal.find("input[name='box_width']"),this.bhInput=this.modal.find("input[name='box_height']"),this.originalData={},this.ratio=this.modal.data("ratio")?this.modal.data("ratio"):2.35,this.imageType=2.35==this.ratio?"/cover_":"/medium_",this.x=0,this.y=0,this.w=0,this.h=0,this.bw=0,this.bh=0,this.init()}imageCropper.prototype={constructor:imageCropper,init:function(){this.addListener(),""!=$('input[name="cloned"]').val()&&(this.galleryImage='<img src="/'+$('input[name="cloned"]').val()+'"  alt="cover photo" class="img-responsive">')},addListener:function(){$(document).on("click",".image-select",$.proxy(this.upload,this)),this.uploadButton.on("change",$.proxy(this.getImage,this)),this.galleryRow.on("change",$.proxy(this.updatedRow,this)),this.modalImage.on("load",$.proxy(this.openModal,this)),this.modal.on("shown.bs.modal",$.proxy(this.crop,this)),this.modal.on("hidden.bs.modal",$.proxy(this.destroyCrop,this)),this.croppedForm.on("submit",$.proxy(this.submitForm,this)),$(document).on("click",".gallery-option",$.proxy(this.clickGalleryOption,this))},upload:function(){this.uploadButton.trigger("click")},getImage:function(i){if(self=this,i.target.files&&i.target.files[0]){var t=new FileReader;t.onload=function(i){self.modalImage.attr("src",i.target.result)},t.readAsDataURL(i.target.files[0])}},openModal:function(){this.modal.modal("show")},closeModal:function(){this.modal.modal("hide")},crop:function(){self=this,this.image=this.modal.find(".bootstrap-modal-cropper img"),this.image.cropper({data:this.originalData,aspectRatio:this.ratio,done:function(i){self.x=i.x,self.y=i.y,self.w=i.width,self.h=i.height}})},destroyCrop:function(){this.image.cropper("destroy"),self.modalImage.attr("src",null),this.uploadButton.val("")},submitForm:function(i){i.preventDefault(),this.bw=this.image.cropper("getImageData").width,this.bh=this.image.cropper("getImageData").height,this.xInput.val(this.x),this.yInput.val(this.y),this.wInput.val(this.w),this.hInput.val(this.h),this.bwInput.val(this.bw),this.bhInput.val(this.bh),this.ajaxUpload()},ajaxUpload:function(){var i=this.croppedForm.attr("action"),t=new FormData(this.croppedForm[0]),a=this;$.ajax(i,{type:"post",data:t,processData:!1,contentType:!1,beforeSend:function(){a.croppedForm.find("input[type='submit']").prop("disabled",!0).after('<span id="cropping-loading" class="icon icon-loading ml10"></span>'),a.image.cropper("disable")},success:function(i){a.galleryValue=i.filename,a.galleryImage='<img src="/'+i.folder+a.imageType+i.filename+'" alt="cover photo" class="img-responsive">',a.croppedForm.find("input[type=submit]").prop("disabled",!1),a.uploadForm.append(a.galleryImage),$("#first-img")&&($("#first-img").html(a.galleryImage),$("#first-img").append('<div class="holder-add-more"><span class="image-select icon-lg icon-md-camera hover"></span>')),$('input[name="gallery_image"]').length&&$('input[name="gallery_image"]').val(!1),$('input[name="image"]').val(a.galleryValue).trigger("change")},error:function(i,t,a){console.log(i+" - "+t+" - "+a)},complete:function(){$("#cropping-loading").remove(),a.closeModal()}})},clickGalleryOption:function(i){this.galleryValue=$(i.target).data("id"),this.uploadForm.append('<img src="'+$(i.target).data("large")+'" alt="cover image" class="img-responsive">'),$('input[name="image"]').val(this.galleryValue).trigger("change"),$('input[name="gallery_image"]').length&&$('input[name="gallery_image"]').val(!0)},updatedRow:function(){""!=this.galleryImage&&'<img src="/undefined"  alt="cover photo" class="img-responsive">'!=this.galleryImage&&($("#first-img").html(this.galleryImage),$("#first-img").append('<div class="holder-add-more"><span class="image-select icon-lg icon-md-camera hover"></span>'))}};
function createVenue(e){this.container=e,this.form=e.find("#create_venue"),this.next=this.form.find(".next"),this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.venueName={message:"Your Venue is not valid",validators:{notEmpty:{message:"Your Venue requires a name"},stringLength:{min:2,max:50,message:"Your Venue name must be more than 2 and less than 50 characters long"}}},this.venueStreet={message:"Your street is not valid",validators:{notEmpty:{message:"Your Venue requires a street"},stringLength:{min:2,max:50,message:"Your street name must be more than 2 and less than 50 characters long"}}},this.town={message:"Your town is not valid",validators:{notEmpty:{message:"Your Venue requires a town"},stringLength:{min:2,max:50,message:"Your town name must be more than 2 and less than 50 characters long"}}},this.venuePC={message:"Your post code is not valid",validators:{notEmpty:{message:"Your Venue requires a post code"},stringLength:{min:6,max:8,message:"Your post code must be more than 6 and less than 8 characters long"}}},this.init()}createVenue.prototype={constuctor:createVenue,init:function(){this.addListener(),this.validation(),this.form.find("input[type='submit']").prop("disabled",!0)},addListener:function(){this.next.on("click",$.proxy(this.switchTab,this))},switchTab:function(e){e.preventDefault();var n=$(e.target).data("target");$("#"+n+"-pill").click()},validation:function(){var e=this;$(this.form).bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{name:this.venueName,address:this.venueStreet,town:this.town,postcode:this.venuePC}}).on("success.form.bv",function(n){n.preventDefault(),e.ajaxUpload()})},ajaxUpload:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){e.form.find("input[type='submit']").prop("disabled",!0).after('<span id="venue-loading" class="icon icon-loading ml10"></span>')},success:function(n){1==n.validation_failed?e.failedValidation(n):(e.container.modal("hide"),e.form.find("input[type=submit]").prop("disabled",!1),$("#venue_select").append($("<option />",{text:n.venue_name,value:n.venue_id,selected:!0})))},error:function(e,n,t){console.log(e+" - "+n+" - "+t)},complete:function(){$("#venue-loading").remove()}})},failedValidation:function(e){console.log(e),self=this;var n=e.errors;$("#venue-pill").trigger("click"),$.each(n,function(e,n){console.log(e),self.form.find('input[name="'+e+'"]').parent().addClass("has-error"),self.form.find('input[name="'+e+'"]').parent().find(".glyphicon").remove(),self.form.find('input[name="'+e+'"]').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+e+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+e+'" data-bv-result="INVALID">'+n+"</small>"),self.form.find('input[name="'+e+'"]').after('<i class="form-control-feedback bv-no-label glyphicon glyphicon-remove" data-bv-icon-for="'+e+'"></i>')})}};
function categorySelect(e){this.form=e,this.select=this.form.find(".select2"),this.keywordSelect=this.form.find('input[name="keywords"]'),this.keywords=[],this.keys=[],this.gallery="",this.maximumSelectionSize=3,this.minimumResultsForSearch=1,this.placeholder="Choose upto 3 categories",this.dropdownCssClass="select2-hidden",this.init()}categorySelect.prototype={constructor:categorySelect,init:function(){this.select.select2({maximumSelectionSize:this.maximumSelectionSize,minimumResultsForSearch:this.minimumResultsForSearch,placeholder:this.placeholder,closeOnSelect:!0,openOnEnter:!1,formatNoMatches:function(){return""},dropdownCssClass:this.dropdownCssClass}),this.addListener()},addListener:function(){this.form.on("submit",$.proxy(this.submitForm,this)),this.select.on("select2-selecting",$.proxy(this.addToKeywords,this)),this.select.on("select2-removing",$.proxy(this.removeFromKeywords,this)),$(document).on("swiperight","#image-carousel",function(){$(this).carousel("next")}),$(document).on("swipeleft","#image-carousel",function(){$(this).carousel("prev")})},submitForm:function(e){e.preventDefault(),this.ajaxUpload()},ajaxUpload:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){$("#gallery-row").after('<div id="gallery-loading"  class="alert alert-success text-center"><span class="icon icon-loading ml10"></span> Loading gallery based on your selected categories...</div>')},success:function(t){e.gallery=t.view,$("#gallery-row").html(e.gallery).trigger("change")},error:function(e,t,s){console.log(e+" - "+t+" - "+s)},complete:function(){e.select.prop("disabled",!1),$("#gallery-loading").remove()}})},addToKeywords:function(e){this.keys.push(e.choice.id),this.keywords.push(e.choice.text),this.keywordSelect.val(this.keywords),this.updateCategoriesInput(),this.form.submit()},removeFromKeywords:function(e){this.keywords=$.grep(this.keywords,function(t){return t!=e.choice.text}),this.keys=$.grep(this.keys,function(t){return t!=e.choice.id}),this.updateCategoriesInput()},updateCategoriesInput:function(){$('input[name="category_array[]"]').val(this.keywords).trigger("change")}};
function createClass(a){this.form=a,this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.className={validators:{notEmpty:{message:"Your class name is required"},stringLength:{min:3,max:50,message:"Your class name must be more than 3 and less than 50 characters long"}}},this.classDescription={validators:{notEmpty:{message:"Your class needs a description"},stringLength:{min:50,max:500,message:"Your class description must be more than 50 and less than 500 characters long"}}},this.init()}createClass.prototype={constructor:createClass,init:function(){this.validation(),this.addListener()},addListener:function(){$(document).on("change",'input[name="image"]',$.proxy(this.reValidate,this)),$(document).on("change",'input[name="category_array[]"]',$.proxy(this.reValidate,this))},validation:function(){var a=this;$(this.form).on("init.form.bv",function(a,t){t.bv.disableSubmitButtons(!0)}).bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{class_name:this.className,class_description:this.classDescription}}).on("success.field.bv",function(){$("input[name='image']").val()||$("input[name='category_array[]']").val()||a.form.find("input[type='submit']").prop("disabled",!0)}).on("success.form.bv",function(t){t.preventDefault(),$("input[name='image']").val()?$("input[name='category_array[]']").val()?(a.form.find("input[type='submit']").prop("disabled",!1),a.ajaxUpload()):a.form.find("input[type='submit']").parent().parent().before('<div data-dismiss="alert" class="alert alert-danger">You must select at least one category before you can proceed<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span></button></div>'):a.form.find("input[type='submit']").parent().parent().before('<div data-dismiss="alert" class="alert alert-danger">You must add a cover image before you can proceed<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span></button></div>')})},ajaxUpload:function(){var a=this;$.ajax(a.form.attr("action"),{type:"post",data:a.form.serialize(),dataType:"json",beforeSend:function(){a.form.find("input[type='submit']").prop("disabled",!0).after('<span id="class-loading" class="icon icon-loading ml10"></span>')},success:function(t){1==t.validation_failed?(a.failedValidation(t),console.log(t)):window.location.href=t.url},error:function(a,t,e){console.log(a+" - "+t+" - "+e)},complete:function(){$("#class-loading").remove()}})},reValidate:function(){$("input[name='image']").val()&&$("input[name='category_array[]']").val()&&this.form.find("input[type='submit']").prop("disabled",!1)},failedValidation:function(a){var t=this,e=a.errors;$.each(e,function(a,e){"venue_select"==a?(t.form.find("#venue_select").parent().parent().addClass("has-error"),t.form.find("#venue_select").parent().after('<small class="help-block custom-inline-error" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+e+"</small>")):t.form.find('input[name="'+a+'"]').parent().hasClass("input-group")?(t.form.find('input[name="'+a+'"]').parent().parent().addClass("has-error"),t.form.find('input[name="'+a+'"]').parent().after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+e+"</small>"),t.form.find('input[name="'+a+'"]').parent().after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+a+'"></i>')):(t.form.find('input[name="'+a+'"]').parent().addClass("has-error"),t.form.find('input[name="'+a+'"]').parent().find(".glyphicon").remove(),t.form.find('input[name="'+a+'"]').parent().find(".help-block:visible").remove(),t.form.find('input[name="'+a+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+e+"</small>"),t.form.find('input[name="'+a+'"]').after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+a+'"></i>'))})}};
function UpdateSessions(t){this.form=t,this.saveOnly=!1,self.data="",this.init()}UpdateSessions.prototype={constructor:UpdateSessions,init:function(){this.addListeners()},addListeners:function(){$(document).on("click","#save",$.proxy(this.justSave,this)),$(document).on("submit","#update-sessions",$.proxy(this.submitUpdate,this)),$(document).on("click","#more-sessions",$.proxy(this.scrollToCalendar,this))},justSave:function(t){t.preventDefault(),this.saveOnly=!0,this.form.find('input[name="preview"]').val("no"),$("#update-sessions").trigger("submit")},submitUpdate:function(t){t.preventDefault(),this.ajaxUpload()},ajaxUpload:function(){var t=this;t.data=t.form.serialize(),$.ajax(t.form.attr("action"),{type:"post",data:t.data,dataType:"json",beforeSend:function(){t.form.find("input[type='submit']").prop("disabled",!0).append('<span id="sessionupdate-loading" class="icon icon-loading ml10 mt10"></span>')},success:function(e){0==t.saveOnly?window.location.href=e.url:($("body").append(e.view),t.saveOnly=!1,t.form.find('input[name="preview"]').val("yes"))},error:function(){console.log("error")},complete:function(){t.form.find("input[type='submit']").prop("disabled",!1),$("#sessionupdate-loading").remove()}})},scrollToCalendar:function(t){t.preventDefault();var e=$(t.target).attr("href");$("html, body").animate({scrollTop:$(e).offset().top-60},1e3)}};
function previewBox(i){this.box=i,this.height=this.box.height(),this.init()}previewBox.prototype={constructor:previewBox,init:function(){$("#nav").css("margin-top",this.height)}};
function publishClass(i){this.form=i,this.addListeners()}publishClass.prototype={constructor:publishClass,addListeners:function(){this.form.on("submit",$.proxy(this.submitForm,this))},submitForm:function(i){i.preventDefault(),this.ajaxPost()},ajaxPost:function(){var i=this;$.ajax(i.form.attr("action"),{type:"post",data:i.form.serialize(),dataType:"json",beforeSend:function(){i.form.find("input[type='submit']").prop("disabled",!0).after('<span id="publish-loading" class="icon icon-loading ml10"></span>')},success:function(t){$("body").append(t.view),console.log(t.state),1==t.state?(i.form.find("input[type='submit']").val("Un-publish"),i.form.find("input[name='publish']").val(0)):(i.form.find("input[type='submit']").val("Publish"),i.form.find("input[name='publish']").val(1))},error:function(i,t,s){console.log(i+" - "+t+" - "+s)},complete:function(){i.form.find("input[type='submit']").prop("disabled",!1),$("#publish-loading").remove()}})}};
function facebookRedirect(t){this.btn=t,this.url=t.attr("href"),this.redirect="",this.addListeners()}facebookRedirect.prototype={constructor:facebookRedirect,addListeners:function(){$('input[name="trainer"]').on("change",$.proxy(this.changeFbUrl,this))},changeFbUrl:function(t){var e=$(t.target).val();"yes"==e?(this.redirect="trainers.create",$('input[name="phone"]').length>0&&$("label[for='phone']").find("small").text("(For Evercise to contact you)")):(this.redirect="",$('input[name="phone"]').length>0&&$("label[for='phone']").find("small").text("(Get alerts about your classes)")),this.btn.attr("href",this.url+this.redirect)}};
function voucher(e){this.elem=e,this.form=this.elem.find("form"),this.addListeners()}voucher.prototype={constructor:voucher,addListeners:function(){$("#have-voucher").on("click",$.proxy(this.haveVoucher,this)),this.form.on("submit",$.proxy(this.submit,this))},haveVoucher:function(e){$(e.target).hasClass("active")?($(e.target).removeClass("active"),$("#have-voucher-block").addClass("hidden")):($(e.target).addClass("active"),$("#have-voucher-block").removeClass("hidden"))},submit:function(e){e.preventDefault(),this.ajaxSubmit()},ajaxSubmit:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){e.form.find('input[type="submit"]').prop("disabled",!0),$(".has-error").removeClass("has-error"),$(".help-block").remove()},success:function(o){o.success?location.reload():e.form.find('input[name="coupon"]').parent().addClass("has-error").append('<span class="help-block mb5">your voucher is not correct</span>')},error:function(e,o,t){console.log(e+" - "+o+" - "+t)},complete:function(){e.form.find('input[type="submit"]').prop("disabled",!1)}})}};
function AddSessionsToCalendar(e){this.form=e,this.calendar=this.form.find("#calendar"),this.index="",this.dates=[],this.selectedDates=[],this.submitDates=[],this.currentMonthYear=[],this.init()}AddSessionsToCalendar.prototype={constructor:AddSessionsToCalendar,init:function(){this.calendar.datepicker({format:"yyyy-mm-dd",startDate:"+1d",todayHighlight:!0,multidate:!0}).on("changeDate",$.proxy(this.getCurrentDates,this)),this.addListener()},addListener:function(){$(document).on("click",".dow",$.proxy(this.dayOfWeek,this)),this.form.on("submit",$.proxy(this.submitForm,this))},getCurrentDates:function(e){var t=this;this.selectedDates=e.dates,this.dates=[],$.each(this.selectedDates,function(e,a){t.dates.push({key:a.valueOf(),dates:a})})},dayOfWeek:function(e){this.currentMonthYear=$(".datepicker-switch").first().text().split(" ");var t=new Date,a=this.getMonthNumber(this.currentMonthYear[0],this.currentMonthYear[1]),s=this.currentMonthYear[1],n=this;for(this.index=$(e.target).index(),t.setDate(1),t.setMonth(a),t.setFullYear(s);t.getDay()!==this.index;)t.setDate(t.getDate()+1);for(;t.getMonth()===a;){var i=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)+" 00:00:00 AM";i=i.replace(/-/g,"/");var r=new Date(i),o=$.grep(n.dates,function(e){return e.key==r.valueOf()}),d=$.grep(n.dates,function(e){return e.key==r.valueOf()-36e5});0==o.length&&0==d.length?n.dates.push({key:r.valueOf(),dates:r}):n.dates=n.dates.filter(function(e){return e.key!==r.valueOf()}),t.setDate(t.getDate()+7)}this.setCalendarDates()},setCalendarDates:function(){var e=[],t={};$.each(this.dates,function(a,s){t[s.key]||(t[s.key]=!0,e.push(s.dates))}),this.calendar.datepicker("setDates",e)},getMonthNumber:function(e,t){var a=Date.parse(e+"1, "+t);return isNaN(a)?-1:new Date(a).getMonth()},submitForm:function(e){e.preventDefault(),$("#duplicate").remove();var t,a=this,s=JSON.parse(a.form.find('input[name="checkDates"]').val());$.each(this.calendar.datepicker("getDates"),function(e,n){var i=n.getDate(),r=n.getMonth()+1,o=n.getFullYear();return a.submitDates.push(o+"-"+r+"-"+i),a.checkDates(s,o+"-"+r+"-"+i+" "+$('select[name="time"]').val())?(t=!0,!1):void 0}),t?a.form.find('input[type="submit"]').parent().before('<div class="alert alert-danger text-center"  id="duplicate">Duplicate Time and date found, please check</div>'):($('input[name="session_array"]').val(this.submitDates),this.ajaxUpload())},checkDates:function(e,t){var a;return $.each(e,function(e,s){var n=new Date(s.date),i=new Date(t);return n.valueOf()==i.valueOf()?(a=!0,!1):void 0}),a},ajaxUpload:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){e.form.find("input[type='submit']").prop("disabled",!0).parent().after('<span id="session-loading" class="icon icon-loading ml10 mt10"></span>')},success:function(t){$("#update-session").html(t.view),$('input[name="recurring"][value="no"]').click(),e.dates=[],e.submitDates=[],e.selectedDates=[],e.setCalendarDates(),$("html, body").animate({scrollTop:$("#update-container").offset().top-20},1e3),0==RemoveSession.length&&new RemoveSession($(".remove-session"))},error:function(){console.log("error")},complete:function(){e.form.find("input[type='submit']").prop("disabled",!1),$("#session-loading").remove()}})}};
function registerUser(a){this.form=a,this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.displayName={message:"Your username is not valid",validators:{notEmpty:{message:"Your display name is required"},stringLength:{min:5,max:20,message:"Your display name must be more than 5 and less than 20 characters long"},regexp:{regexp:/^[a-zA-Z0-9_]+$/,message:"Your display name can only consist of alphabetical, number and underscore"}}},this.email={validators:{notEmpty:{message:"Your email is required and cannot be empty"},emailAddress:{message:"Your email is not a valid email address"}}},this.first_name={validators:{notEmpty:{message:"Your first name is required and cannot be empty"},stringLength:{min:2,max:15,message:"Your first name must be more than 2 and less than 15 characters long"}}},this.last_name={validators:{notEmpty:{message:"Your surname is required and cannot be empty"},stringLength:{min:2,max:15,message:"Your surname must be more than 2 and less than 15 characters long"}}},this.password={validators:{notEmpty:{message:"Your password is required and cannot be empty"},stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"confirmed_password",message:"Your passwords do not match"}}},this.confirmed_password={validators:{notEmpty:{message:"Your password is required and cannot be empty"},stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"password",message:"Your passwords do not match"}}},this.init()}registerUser.prototype={constructor:registerUser,init:function(){this.form.find("input[type='submit']").prop("disabled",!0),this.validation(),this.addListeners()},addListeners:function(){this.form.find('input[name="terms"]').on("change",$.proxy(this.reVal,this))},reVal:function(a){$(a.target).is(":checked")&&this.form.data("bootstrapValidator").isValid()&&this.form.find("input[type='submit']").prop("disabled",!1)},validation:function(){var a=this;this.form.bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{display_name:this.displayName,email:this.email,first_name:this.first_name,last_name:this.last_name,password:this.password,confirmed_password:this.confirmed_password}}).on("success.form.bv",function(e){e.preventDefault(),a.form.find('input[name="terms"]').is(":checked")||0==a.form.find('input[name="terms"]').length?a.ajaxUpload():a.form.find('input[name="terms"]').parent().append('<span class="center-block text-danger help-box">You must accept our terms and conditions before continuing</span>')})},ajaxUpload:function(){var a=this;$.ajax(a.form.attr("action"),{type:"post",data:a.form.serialize(),dataType:"json",beforeSend:function(){a.form.find("input[type='submit']").prop("disabled",!0).after('<br><span id="register-loading" class="icon icon-loading ml10"></span>')},success:function(e){1==e.validation_failed?a.failedValidation(e):window.location.href=e.url},error:function(a,e,s){console.log(a+" - "+e+" - "+s)},complete:function(){a.form.find("input[type=submit]").prop("disabled",!1),$("#register-loading").remove()}})},failedValidation:function(a){self=this;var e=a.errors;$.each(e,function(a,e){self.form.find('input[name="'+a+'"]').parent().hasClass("input-group")?(self.form.find('input[name="'+a+'"]').parent().parent().addClass("has-error"),self.form.find('input[name="'+a+'"]').parent().after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+e+"</small>"),self.form.find('input[name="'+a+'"]').parent().after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+a+'"></i>')):(self.form.find('input[name="'+a+'"]').parent().addClass("has-error"),self.form.find('input[name="'+a+'"]').parent().find(".glyphicon").remove(),self.form.find('input[name="'+a+'"]').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+a+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+e+"</small>"),self.form.find('input[name="'+a+'"]').after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+a+'"></i>'))})}};
var Profile=function(t){this.nav=t,this.top=0,this.speed=400,this.init()};Profile.prototype={constructor:Profile,init:function(){this.top=Math.floor(this.nav.offset().top-this.nav.outerHeight(!0));var t=this;$(document).on("click",".nav-pills li a",function(){destination=$(this).attr("href"),$(".nav-pills li").removeClass("active"),$(this).parent().addClass("active"),$(".profile-panels").addClass("hidden"),$(destination).removeClass("hidden"),new Masonry($(".masonry")),t.scroll()})},scroll:function(){}};
function registerTrainer(i){this.form=i,this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.profession={message:"Your profession is not valid",validators:{notEmpty:{message:"You must add a profession"},stringLength:{min:2,max:50,message:"Your profession must be more than 2 and less than 50 characters long"}}},this.bio={message:"Your bio is not valid",validators:{notEmpty:{message:"You must add a bio"},stringLength:{min:50,max:500,message:"Your bio must be more than 50 and less than 500 characters long"}}},this.init()}registerTrainer.prototype={constructor:registerTrainer,init:function(){this.form.find("input[type='submit']").prop("disabled",!0),this.addListeners(),this.validation()},addListeners:function(){$('input[name="image"]').on("change",$.proxy(this.closeAlert,this))},validation:function(){var i=this;this.form.bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{profession:this.profession,bio:this.bio}}).on("success.form.bv",function(e){e.preventDefault(),i.closeAlert(),i.checkImage()})},checkImage:function(){$('input[name="image"]').val()?this.ajaxUpload():($("html, body").animate({scrollTop:$("#image-select").offset().top},200),$(".img-uploader").after('<div class="alert alert-danger alert-dismissible fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>You must upload i profile image</div>'),this.form.find("input[type='submit']").prop("disabled",!1))},closeAlert:function(){$(".close").trigger("click")},ajaxUpload:function(){var i=this;$.ajax(i.form.attr("action"),{type:"post",data:i.form.serialize(),dataType:"json",beforeSend:function(){i.form.find("input[type='submit']").prop("disabled",!0).after('<span id="register-loading" class="icon icon-loading ml10"></span>')},success:function(e){1==e.validation_failed?i.failedValidation(e):window.location.href=e.url},error:function(i,e,a){console.log(i+" - "+e+" - "+a)},complete:function(){i.form.find("input[type=submit]").prop("disabled",!1),$("#register-loading").remove()}})},failedValidation:function(i){self=this;var e=i.errors;$.each(e,function(i,e){self.form.find('input[name="'+i+'"]').parent().addClass("has-error"),self.form.find('input[name="'+i+'"]').parent().find(".glyphicon").remove(),self.form.find('input[name="'+i+'"]').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+i+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+i+'" data-bv-result="INVALID">'+e+"</small>"),self.form.find('input[name="'+i+'"]').after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+i+'"></i>')})}};
function scrollTo(t){this.nav=t,this.target="",this.top=$("#nav").outerHeight(),this.addListeners()}scrollTo.prototype={constructor:scrollTo,addListeners:function(){this.nav.find('a[target!="_blank"]').on("click",$.proxy(this.scroll,this))},scroll:function(t){t.preventDefault(),this.target=$(t.target).attr("href"),$("html, body").animate({scrollTop:$(this.target).offset().top-this.top},300)}};
function profileNav(t){this.nav=t,this.scroll=0,this.stickyTop=this.nav.offset().top,this.url=document.URL,this.lastOfUrl="",this.init(),this.addListeners()}profileNav.prototype={constructor:profileNav,init:function(){new Masonry($(".masonry"))},addListeners:function(){$(window).scroll($.proxy(this.checkScrollPosition,this)),$(window).on("popstate",$.proxy(this.checkHistoryState,this)),this.nav.find("a").on("click",$.proxy(this.changeTabs,this))},checkScrollPosition:function(t){this.scroll=$(t.target).scrollTop(),this.scroll>this.stickyTop?this.addStickyClass():this.removeStickyClass()},checkHistoryState:function(t){"popstate"==t.type&&(this.getUrl(),$(".nav-pills li").removeClass("active"),$('a[href="#'+this.lastOfUrl+'"]').parent().addClass("active"),$(".profile-panels").addClass("hidden"),$("#"+this.lastOfUrl).removeClass("hidden"),new Masonry($(".masonry")))},addStickyClass:function(){this.nav.addClass("navbar-fixed-top"),$(".profile-panels").css({"margin-top":this.nav.outerHeight(!0)})},removeStickyClass:function(){this.nav.removeClass("navbar-fixed-top"),$(".profile-panels").css({"margin-top":0})},changeTabs:function(t){t.preventDefault();var s=$(t.target).attr("href").substring(1);$(".nav-pills li").removeClass("active"),$(t.target).parent().addClass("active"),$(".profile-panels").addClass("hidden"),$("#"+s).removeClass("hidden"),this.getUrl(),this.nav.data("name")==this.lastOfUrl?window.history.pushState(null,this.lastOfUrl+"/"+s,this.lastOfUrl+"/"+s):window.history.pushState(null,s,s),new Masonry($(".masonry"))},getUrl:function(){var t=window.location.pathname,s=t.split("/");s.reverse(),this.lastOfUrl=""!=s[0]?s[0]:s[1]}};
function RateIt(t){this.block=t,this.currentBlock="",this.form="",this.hoverNth=null,this.selectedNth=null,this.stars=0,this.emptyClass="icon-empty-star",this.selectedClass="icon-full-star",this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.feedback_text={message:"Your must rate this class out of 5",validators:{notEmpty:{message:"We need to know your thoughts on this class before you rate it"}}},this.init()}RateIt.prototype={constructor:RateIt,init:function(){this.block.find("input[type='submit']").prop("disabled",!0),this.addListeners(),this.validation()},addListeners:function(){this.block.find("span.icon").not(".selected").hover($.proxy(this.hoverState,this)),this.block.find("span.icon").on("click",$.proxy(this.selectRating,this)),this.block.find("textarea").on("focus",$.proxy(this.focusTextArea,this))},hoverState:function(t){this.currentBlock=$(t.target).closest(".rate-it"),this.hoverNth="mouseenter"==t.type?$(t.target).index():null,this.changeClassOnHover()},changeClassOnHover:function(){if(null!=this.hoverNth)for(var t=0;t<=this.hoverNth;t++)this.currentBlock.find("span.icon").eq(t).removeClass(this.emptyClass).addClass(this.selectedClass);else this.currentBlock.find("span.icon").not(".selected").removeClass(this.selectedClass).addClass(this.emptyClass)},selectRating:function(t){this.currentBlock=$(t.target).closest(".rate-it"),this.currentBlock.find(".alert").remove();var s=this;setTimeout(function(){s.currentBlock.find('textarea[name="feedback_text"]').focus()},1),this.selectedNth=$(t.target).index(),this.stars=this.selectedNth+1,this.currentBlock.find("span.icon").removeClass(this.selectedClass).removeClass("selected").addClass(this.emptyClass);for(var e=0;e<=this.selectedNth;e++)this.currentBlock.find("span.icon").eq(e).removeClass(this.emptyClass).addClass(this.selectedClass).addClass("selected");this.currentBlock.find('input[name="stars"]').val(this.stars)},focusTextArea:function(t){this.currentBlock=$(t.target).closest(".rate-it"),this.currentBlock.find(".alert").remove(),$(t.target).val()&&this.currentBlock.find("input[type='submit']").prop("disabled",!1)},validation:function(){var t=this;this.block.find("form").bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{feedback_text:this.feedback_text}}).on("success.form.bv",function(s){s.preventDefault(),t.form=$(s.target),t.currentBlock=t.form.closest(".rate-it"),t.currentBlock.find(".alert").remove(),t.ratingCheck()})},ratingCheck:function(){this.form.find('input[name="stars"]').val()?this.ajaxUpload():(this.currentBlock.find("span.icon").css({transform:"rotate(360deg)",WebkitTransition:"transform 1s ease-in-out",MozTransition:"transform 1s ease-in-out",MsTransition:"transform 1s ease-in-out",OTransition:"transform 1s ease-in-out",transition:"transform 1s ease-in-out"}),this.form.append('<div class="alert alert-danger alert-dismissible fade in absolute alert-sm" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>You must add your star rating</div>'))},ajaxUpload:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find("input[type='submit']").prop("disabled",!0).after('<span id="rating-loading" class="icon icon-loading ml10"></span>')},success:function(s){1==s.validation_failed?t.failedValidation(s):window.location.href=s.url},error:function(t,s,e){console.log(t+" - "+s+" - "+e)},complete:function(){t.form.find("input[type=submit]").prop("disabled",!1),$("#rating-loading").remove()}})},failedValidation:function(t){self=this;var s=t.errors;$.each(s,function(t,s){self.form.find('input[name="'+t+'"]').parent().addClass("has-error"),self.form.find('input[name="'+t+'"]').parent().find(".glyphicon").remove(),self.form.find('input[name="'+t+'"]').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+t+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+t+'" data-bv-result="INVALID">'+s+"</small>")})}};
function LocationAutoComplete(t){this.input=t,this.autoCompleteStarted=!1,this.addScript=!1,this.mapOptions={},this.address_components=[],this.town="london",this.width=0,this.form,this.init()}LocationAutoComplete.prototype={constructor:LocationAutoComplete,init:function(){this.form=this.input.closest("form");var t=this;if("undefined"!=typeof angular)window.google?this.load():setTimeout(function(){t.init()},1e3);else{if(!t.addScript){var o=document.createElement("script");o.src="//maps.googleapis.com/maps/api/js?libraries=places&callback=autocomplete.load",o.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(o),t.addScript=!0}setTimeout(function(){t.init()},500)}},load:function(){if(void 0==google.maps||this.autoCompleteStarted){var t=this;setTimeout(function(){t.load()},500)}else this.autoCompleteStarted=!0,this.addListeners()},addListeners:function(){var t=this;this.input.keyup(function(){if(!(this.value.length<2)){var o=new google.maps.places.AutocompleteService;o.getPlacePredictions({input:t.input.val()},function(t,o){if(o==google.maps.places.PlacesServiceStatus.OK){$("#locaction-autocomplete .autocomplete-content").html("");for(var e,i=0;e=t[i];i++)$("#locaction-autocomplete .autocomplete-content").append('<li><a href="'+e.description+'">'+e.description+"</a></li>")}})}}),$(document).on("click","#locaction-autocomplete .autocomplete-content a",$.proxy(this.changeLocation,this))},changeLocation:function(t){t.preventDefault();var o=$(t.target).attr("href"),e=this;geocoder=new google.maps.Geocoder,this.form=this.input.closest("form"),geocoder.geocode({address:o},function(t,o){if(t[0]&&"OK"==o){var i=t[0].formatted_address;e.form.find('input[name="location"]').val(i),e.getTown(t[0].address_components),e.form.find('input[name="city"]').val(e.town)}else console.log(o)})},getTown:function(t){for(var o=this,e=t,i=0;i<e.length;++i)"locality"==e[i].types[0]?o.town=e[i].long_name:"political"==e[i].types[0]?o.town=e[i].long_name:"postal_town"==e[i].types[0]&&(o.town=e[i].long_name)}};
function topUp(t){this.form=t,this.amount=0,this.payAmount=0,this.stripe={},this.init()}topUp.prototype={constructor:topUp,init:function(){$("#stripe-button").prop("disabled",!0),$("#fb-pay").addClass("disabled"),this.addListeners()},addListeners:function(){this.form.find(".add-btn").on("click",$.proxy(this.topUpAmount,this)),this.form.find('input[name="custom"]').on("keyup change",$.proxy(this.topUpAmount,this)),this.form.find("#cancel-btn").on("click",$.proxy(this.cancelTopUp,this)),this.form.find('input[name="amount"]').on("change",$.proxy(this.amountChanged,this)),this.form.find("#stripe-button").on("click",$.proxy(this.openStripe,this)),$(window).on("popstate",$.proxy(this.closeStripe,this)),this.form.on("submit",$.proxy(this.submitForm,this))},topUpAmount:function(t){t.preventDefault(),this.amount=$(t.target).val()?$(t.target).val():$(t.target).data("amount"),this.form.find(".add-btn").removeClass("btn-primary"),this.form.find('input[name="custom"]').removeClass("btn-primary"),$(t.target).addClass("btn-primary"),this.updateAmountInput()},cancelTopUp:function(t){t.preventDefault(),this.amount=0,this.form.find(".add-btn").removeClass("btn-primary"),this.form.find('input[name="custom"]').removeClass("btn-primary"),this.updateAmountInput()},updateAmountInput:function(){this.form.find('input[name="amount"]').val(this.amount).trigger("change")},amountChanged:function(){if($("#stripe-button").prop("disabled",!0),$("#fb-pay").addClass("disabled"),this.amount>0){var t=this.amount,n=this;setTimeout(function(){var o=n.amount;t==o&&n.form.trigger("submit")},1e3)}},openStripe:function(t){var n=this;handler.open({name:"Evercise",description:"Top up",amount:n.payAmount}),t.preventDefault()},closeStripe:function(){handler.close()},submitForm:function(t){t.preventDefault(),this.ajaxUpload()},ajaxUpload:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find(".add-btn").prop("disabled",!0),t.form.find('input[name="custom"]').prop("disabled",!0)},success:function(n){$("#stripe-button").prop("disabled",!1),$("#fb-pay").removeClass("disabled"),t.payAmount=n.amount},error:function(t,n,o){console.log(t+" - "+n+" - "+o)},complete:function(){t.form.find(".add-btn").prop("disabled",!1),t.form.find('input[name="custom"]').prop("disabled",!1)}})}};
function checkout(e){this.checkout=e,this.viewPrice=viewPrice,this.addListeners()}checkout.prototype={construstor:checkout,addListeners:function(){this.checkout.find("#stripe-button").on("click",$.proxy(this.openStripe,this)),$(window).on("popstate",$.proxy(this.closeStripe,this))},openStripe:function(e){var t=this;handler.open({name:"Evercise",description:"Checkout",amount:t.viewPrice}),e.preventDefault()},closeStripe:function(){handler.close()}};
function Referral(e){this.form=e,this.addListeners()}Referral.prototype={constructor:Referral,addListeners:function(){this.form.on("submit",$.proxy(this.submitForm,this)),this.form.find("input[name='referee_email']").on("keydown",$.proxy(this.emailChange,this))},emailChange:function(e){$(e.target).parent().addClass("has-error")&&($(e.target).parent().removeClass("has-error"),this.form.find("#validation-error-text").remove(),this.form.find("#validation-error-icon").remove())},submitForm:function(e){e.preventDefault(),this.ajaxSubmit()},ajaxSubmit:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){e.emailChange(e.form.find("input[name='referee_email']")),e.form.find("input[type='submit']").prop("disabled",!0)},success:function(r){1==r.validation_failed?e.failedValidation(r):(e.form.after(r.view),$("#referral-amount").text(r.referral))},error:function(e,r,a){console.log(e+" - "+r+" - "+a)},complete:function(){e.form.find("input[type=submit]").prop("disabled",!1)}})},failedValidation:function(e){self=this;var r=e.errors;$.each(r,function(e,r){self.form.find('input[name="'+e+'"]').parent().addClass("has-error"),self.form.find('input[name="'+e+'"]').after('<small id="validation-error-text" class="help-block" data-bv-validator="notEmpty" data-bv-for="'+e+'" data-bv-result="INVALID">'+r+"</small>"),self.form.find('input[name="'+e+'"]').after('<i id="validation-error-icon" class="form-control-feedback bv-no-label glyphicon glyphicon-remove" data-bv-icon-for="'+e+'"></i>')})}};
function EditClass(e){this.form=e,this.addListeners()}EditClass.prototype={constructor:EditClass,addListeners:function(){this.form.on("submit",$.proxy(this.submit,this))},submit:function(e){e.preventDefault(),this.form=$(e.target),this.ajax()},ajax:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){e.form.find("input[type='submit']").prop("disabled",!0),e.form.find(".btn-toggle-down").prop("disabled",!0).addClass("loading")},success:function(t){e.edit(t)},error:function(e,t,i){console.log(e+" - "+t+" - "+i)},complete:function(){e.form.find("input[type='submit']").prop("disabled",!1)}})},edit:function(e){$("#"+e.id).html(e.view),$("#edit-"+e.id).removeClass("disabled"),$("#submit-"+e.id).hide(),$("#"+e.id).parent().collapse("show"),$("#infoToggle-"+e.id).removeClass("hide"),datepick(),new UpdateSession($(".update-session")),new RemoveSession($(".remove-session")),new GetMembers($(".get-members"))}};
var Masonry=function(n){this.masonry=n,this.init()};Masonry.prototype={constructor:Masonry,init:function(){var n=this.masonry;n.masonry({itemSelector:".masonry-item",isInitLayout:!0,transitionDuration:0}),n.masonry}};
function updateProfile(a){this.form=a,this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.email={validators:{notEmpty:{message:"Your email is required and cannot be empty"},emailAddress:{message:"Your email is not a valid email address"}}},this.first_name={validators:{stringLength:{min:2,max:15,message:"Your first name must be more than 2 and less than 15 characters long"}}},this.last_name={validators:{stringLength:{min:2,max:15,message:"Your surname must be more than 2 and less than 15 characters long"}}},this.password={validators:{stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"confirmed_password",message:"Your passwords do not match"}}},this.confirmed_password={validators:{stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"password",message:"Your passwords do not match"}}},this.profession={message:"Your profession is not valid",validators:{notEmpty:{message:"You must add a profession"},stringLength:{min:2,max:50,message:"Your profession must be more than 2 and less than 50 characters long"}}},this.bio={message:"Your bio is not valid",validators:{notEmpty:{message:"You must add a bio"},stringLength:{min:50,max:500,message:"Your bio must be more than 50 and less than 500 characters long"}}},this.init()}updateProfile.prototype={constructor:updateProfile,init:function(){this.validation(),this.form.find("input[type='submit']").prop("disabled",!1)},validation:function(){var a=this;this.form.bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{email:this.email,first_name:this.first_name,last_name:this.last_name,password:this.password,confirmed_password:this.confirmed_password,profession:this.profession,bio:this.bio}}).on("success.form.bv",function(s){s.preventDefault(),a.ajaxUpload()})},ajaxUpload:function(){var a=this;$.ajax(a.form.attr("action"),{type:"post",data:a.form.serialize(),dataType:"json",beforeSend:function(){a.form.find("input[type='submit']").prop("disabled",!0).after('<span id="register-loading" class="icon icon-loading ml10"></span>')},success:function(s){1==s.validation_failed?a.failedValidation(s):window.location.href=s.url},error:function(a,s,i){console.log(a+" - "+s+" - "+i)},complete:function(){a.form.find("input[type=submit]").prop("disabled",!1),$("#register-loading").remove()}})},failedValidation:function(a){self=this;var s=a.errors;$.each(s,function(a,s){self.form.find('input[name="'+a+'"],input[textarea="'+a+'"] ').parent().addClass("has-error"),self.form.find('input[name="'+a+'"],input[textarea="'+a+'"] ').parent().find(".glyphicon").remove(),self.form.find('input[name="'+a+'"],input[textarea="'+a+'"] ').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+a+'"],input[textarea="'+a+'"] ').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+s+"</small>"),self.form.find('input[name="'+a+'"],input[textarea="'+a+'"] ').after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+a+'"></i>')})}};
function UpdateSession(t){this.form=t,this.id="",this.addListeners()}UpdateSession.prototype={constructor:UpdateSession,addListeners:function(){$(".update-session-select").on("change",$.proxy(this.sessionChanged,this)),this.form.on("submit",$.proxy(this.submit,this))},sessionChanged:function(t){var i=$(t.target).attr("form");this.form=$("#"+i),this.id=this.form.find('input[name="id"]').val(),console.log("id"+this.id),this.form.trigger("submit")},submit:function(t){t.preventDefault(),this.form=$(t.target),this.ajax()},ajax:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find("input[type='submit']").prop("disabled",!0),$("#hub-edit-row-"+t.id).addClass("bg-info")},success:function(i){t.update(i)},error:function(t,i,s){console.log(t+" - "+i+" - "+s)},complete:function(){t.form.find("input[type='submit']").prop("disabled",!1),$("#hub-edit-row-"+t.id).removeClass("bg-info")}})},update:function(t){$("#hub-edit-row-"+t.id).after(t.view)}};
function RemoveSession(t){this.form=t,this.id="",this.addListeners()}RemoveSession.prototype={constructor:RemoveSession,addListeners:function(){this.form.on("submit",$.proxy(this.submit,this))},submit:function(t){t.preventDefault(),this.form=$(t.target),this.id=this.form.find('input[name="id"]').val(),this.ajax()},ajax:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find("input[type='submit']").prop("disabled",!0),$("#hub-edit-row-"+t.id).addClass("bg-danger")},success:function(i){t.remove(i)},error:function(t,i,o){console.log(t+" - "+i+" - "+o)},complete:function(){t.form.find("input[type='submit']").prop("disabled",!1),$("#hub-edit-row-"+t.id).removeClass("bg-info")}})},remove:function(t){$("#hub-edit-row-"+t.id).fadeOut(400)}};
function listAccordion(t){this.accordion=t,this.addListeners()}listAccordion.prototype={constructor:listAccordion,addListeners:function(){this.accordion.on("shown.bs.collapse",function(t){var o=$(t.target).attr("id");$('a[href="#'+o+'"]').parent().addClass("active")}),this.accordion.on("hidden.bs.collapse",function(t){var o=$(t.target).attr("id");$('a[href="#'+o+'"]').parent().removeClass("active")})}};
function Login(i){this.form=i,this.addListeners()}Login.prototype={constructor:Login,addListeners:function(){this.form.on("submit",$.proxy(this.submit,this)),this.form.find("input").on("input",$.proxy(this.removeError,this))},removeError:function(){this.form.find(".alert").remove()},submit:function(i){i.preventDefault(),this.form=$(i.target),this.ajax()},ajax:function(){var i=this;$.ajax(i.form.attr("action"),{type:"post",data:i.form.serialize(),dataType:"json",beforeSend:function(){i.form.find("input[type='submit']").prop("disabled",!0),i.removeError()},success:function(o){1==o.validation_failed?i.failedValidation(o):window.location.href=o.url},error:function(i,o,t){console.log(i+" - "+o+" - "+t)},complete:function(){i.form.find("input[type='submit']").prop("disabled",!1)}})},failedValidation:function(i){self=this;var o=i.errors;self.form.find("input[name = 'password']").parent().addClass("has-error").after('<div class="form-control input-lg input-group has-error">'+o+"</div>")}};
function MailPopup(i){this.link=i,this.target="",this.form="",this.id="",this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.body={validators:{notEmpty:{message:"Your message requires content"}}},this.addListener()}MailPopup.prototype={constructor:MailPopup,addListener:function(){$(document).on("click",".mail-popup",$.proxy(this.getPopup,this))},getPopup:function(i){i.preventDefault(),this.link=$(i.target),this.id=this.link.data("id"),this.target=$(i.target).attr("href"),this.link.addClass("icon-loading"),this.ajaxGet()},ajaxGet:function(){var i=this;$.get(this.target,function(t){console.log(t),i.link.after(t.view),$("#mail-trainer-"+i.id).modal("show"),i.link.replaceWith('<a  href="#mail-trainer-'+i.id+'" class="icon icon-mail ml10 mt25" data-toggle="modal" data-target="#mail-trainer-'+i.id+'"></a>'),i.form=$("#mail-trainer-"+i.id).find("form"),i.validation()}).fail(function(){alert("error")}).always(function(){i.link.removeClass("icon-loading")})},validation:function(){var i=this;this.form.bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{mail_body:this.body}}).on("success.form.bv",function(t){t.preventDefault(),i.ajaxUpload()})},ajaxUpload:function(){var i=this;$.ajax(i.form.attr("action"),{type:"post",data:i.form.serialize(),dataType:"json",beforeSend:function(){i.form.find("input[type='submit']").prop("disabled",!0).after('<span id="sending-loading" class="icon icon-loading ml10 mt15"></span>')},success:function(){i.form.find("input[type='submit']").before('<strong class="text-primary">Message sent successfully!</strong><br>'),setTimeout(function(){$(".modal").modal("hide")},1500)},error:function(i,t,a){console.log(i+" - "+t+" - "+a)},complete:function(){i.form.find("input[type=submit]").prop("disabled",!1),$("#sending-loading").remove()}})}};
function GetMembers(e){this.form=e,this.addListeners()}GetMembers.prototype={constructor:GetMembers,addListeners:function(){this.form.on("submit",$.proxy(this.submit,this))},submit:function(e){e.preventDefault(),this.form=$(e.target);var t=this.form.find('input[name="session_id"]').val();this.form.find('input[type="submit"]').replaceWith('<a  href="#session-members-'+t+'" class="icon icon-people mr15 hover" data-toggle="modal" data-target="#session-members-'+t+'"></a>'),this.ajax()},ajax:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){e.form.find(".icon-people").addClass("disabled")},success:function(t){e.form.append(t.view),e.form.find(".modal").modal("show")},error:function(e,t,o){console.log(e+" - "+t+" - "+o)},complete:function(){e.form.find(".icon-people").removeClass("disabled")}})}};
function Withdrawal(t){this.form=t,this.modal="",this.addListeners()}Withdrawal.prototype={constructor:Withdrawal,addListeners:function(){this.form.on("submit",$.proxy(this.submit,this)),$(document).on("submit","#request-withdrawal-form",$.proxy(this.submit,this)),$(document).on("input",'input[name="paypal"]',$.proxy(this.removeValidation,this)),$(document).on("input",'input[name="amount"]',$.proxy(this.removeValidation,this))},submit:function(t){t.preventDefault(),this.form=$(t.target),this.ajax()},ajax:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find('input[type="submit"]').prop("disabled",!0)},success:function(a){a.view?($("body").append(a.view),t.form.find('input[type="submit"]').replaceWith('<a  href="#request-withdrawal" class="btn btn-default" data-toggle="modal" data-target="#request-withdrawal">Request Funds</a>'),t.modal=$("#request-withdrawal"),t.modal.modal("show")):1==a.validation_failed?t.failedValidation(a):(t.form.find('input[name="amount"]').addClass("mb40"),t.form.find('input[name="amount"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="amount" data-bv-result="VALID">Withdrawel Successful, We are now refreshing this page for you.</small>'),location.reload())},error:function(t,a,e){console.log(t+" - "+a+" - "+e)},complete:function(){t.form.find('input[type="submit"]').prop("disabled",!1)}})},removeValidation:function(t){$(t.target).parent().removeClass("has-error mb40"),$(t.target).parent().find(".help-block:visible").remove()},failedValidation:function(t){self=this;var a=t.errors;$.each(a,function(t,a){self.form.find('input[name="'+t+'"]').parent().addClass("has-error mb40"),self.form.find('input[name="'+t+'"]').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+t+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+t+'" data-bv-result="INVALID">'+a+"</small>")})}};
function trapezium(i){this.wrapper=i,this.btns=[],this.width=i.outerWidth(),this.margin=parseInt(this.wrapper.find(".btn").css("margin-right")),this.init()}trapezium.prototype={constructor:trapezium,init:function(){if($(window).width()>990){var i=this,t=this.width,r=0,p=1,e=10,n=1,a=0,s=0;this.wrapper.find(".trapezium-item").each(function(d,o){if(r+=$(o).outerWidth(!0),r>=t-20){a=r-t;{i.margin+a/s+"px"}r=0,p=++p,i.wrapper.append('<div class="col-sm-'+e+" col-sm-offset-"+n+' mb30" id="row-'+p+'"></div>'),t=i.wrapper.find("#row-"+p).outerWidth(),t>r&&(r+=$(o).outerWidth(!0),i.wrapper.find("#row-"+p).append(o),e-=2,n=++n)}else++s,i.wrapper.find("#row-"+p).append(o)})}}};
function categoryAutoComplete(t){this.elem=t,this.inputBox=this.elem.parent().find("input"),this.selected="",this.form,this.addListenners()}categoryAutoComplete.prototype={constructor:categoryAutoComplete,addListenners:function(){this.elem.find("a").on("click",$.proxy(this.select,this))},select:function(t){t.preventDefault();var e=$(t.target);this.form=e.closest("form"),this.selected=e.text(),this.form.find('input[name="search"]').val(this.selected)}};
var ToggleSwitch=function(t){this.toggle=t,this.originalClass=t.data("removeclass"),this.switchClass=t.data("switchclass"),this.originalText=t.text(),this.switchText=t.data("switchtext"),this.init()};ToggleSwitch.prototype={constructor:ToggleSwitch,init:function(){this.toggle.text(this.switchText),this.toggle.addClass(this.switchClass),this.toggle.removeClass(this.originalClass),this.toggle.data("switchtext",this.originalText),this.toggle.data("removeclass",this.switchClass),this.toggle.data("switchclass",this.originalClass)}};
function myLocation(){this.town="london",this.btn,this.form,this.addListeners()}myLocation.prototype={constructor:myLocation,addListeners:function(){$(document).on("click",".locator",$.proxy(this.init,this))},init:function(o){this.btn=$(o.target),this.form=$(o.target).closest("form"),o.preventDefault(),o.stopPropagation(),navigator.geolocation.getCurrentPosition($.proxy(this.displayPosition,this),$.proxy(this.displayError,this))},displayPosition:function(o){var t=o.coords.latitude,n=o.coords.longitude;this.getLocation(t,n)},displayError:function(o){var t={1:"Permission denied",2:"Position unavailable",3:"Request timeout"};alert("Error: "+t[o.code])},getLocation:function(o,t){geocoder=new google.maps.Geocoder;var n=new google.maps.LatLng(o,t),i=this;geocoder.geocode({latLng:n},function(o,t){if(o[0]&&"OK"==t){var n=o[0].formatted_address;i.form.find('input[name="location"]').val(n),i.getTown(o[0].address_components),i.form.find('input[name="city"]').val(i.town),i.btn.is("#mobile-sub")&&i.form.trigger("submit")}else console.log(t)})},getTown:function(o){for(var t=this,n=o,i=0;i<n.length;++i)"locality"==n[i].types[0]?t.town=n[i].long_name:"political"==n[i].types[0]?t.town=n[i].long_name:"postal_town"==n[i].types[0]&&(t.town=n[i].long_name)}};
function classCalendar(s){this.calendar=s,this.sessions=s.find('input[name="sessions"]').val(),this.rows=[],this.init()}classCalendar.prototype={constructor:classCalendar,init:function(){var s=JSON.parse(this.sessions),t=this;this.calendar.datepicker({format:"yyyy-mm-dd",startDate:"+1d",weekStart:1,multidate:!0,beforeShowDay:function(e){var i=e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2),a=$.grep(s,function(s){var t=s.date_time;return t=t.split(/\s+/),t[0]==i});if(a.length>0){var n=[];for(var r in a)n.push(a[r].id),t.rows.push({id:a[r].id,list:"<li>"+a[r].date_time+"</li>",show:!1});return{enabled:!0,classes:"session",session:n}}return{enabled:!1,classes:!1,session:!1}}}),this.addListeners()},addListeners:function(){this.calendar.find(".day").on("click",$.proxy(this.dateSelected,this))},dateSelected:function(s){s.preventDefault(),s.stopPropagation();for(var t=$(s.target).data("session").split(","),e=this,i=0;i<t.length;i++)$.grep(e.rows,function(s){s.id==t[i]&&e.calendar.after(s.list)})}};
function Map(a){this.lat=a.data("lat"),this.lng=a.data("lng"),this.zoom=a.data("zoom"),this.icon="/assets/img/icon_default_small_pin.png",this.panel=a.closest("#map-panel"),this.init()}Map.prototype={constructor:Map,init:function(){var a=document.createElement("script");a.src="//www.google.com/jsapi?key=AIzaSyAha5JzFciZvU_rWu_2d2UVl7o4Z8LWdcg&callback=map.load",a.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(a)},load:function(){self=this,google.load("maps","3",{other_params:"sensor=false",callback:function(){var a=new google.maps.Map(document.getElementById("map_canvas"),{center:new google.maps.LatLng(self.lat,self.lng),zoom:self.zoom,mapTypeId:google.maps.MapTypeId.ROADMAP});google.maps.event.trigger(a,"resize");var e=new google.maps.Marker({position:new google.maps.LatLng(self.lat,self.lng),animation:google.maps.Animation.DROP,icon:self.icon});e.setMap(a)}}),this.addMobileCheck()},addMobileCheck:function(){$("#map-panel-mobile").is(":visible")&&$("#map-panel-mobile").append(this.panel)}};
var AjaxRequest=function(t,a){this.form=t,this.actionUrl=t.attr("action"),this.method=t.attr("method"),this.data=t.serialize(),this.dataType="json",this.validationScrollSpeed=200,this.validationoffset=85,this.validationscroll=!1,this.callbackname=a,this.disableButton(),this.init()};AjaxRequest.prototype={constuctor:AjaxRequest,init:function(){self=this,$.ajax({url:self.actionUrl,type:self.method,data:self.data,dataType:self.dataType}).done(function(t){self.callbackSelctor(t)})},disableButton:function(){this.form.find('input[type="submit"]').prop("disabled",!0)},renableButton:function(){this.form.find('input[type="submit"]').prop("disabled",!1)},callbackSelctor:function(t){"error"==t.callback?self.failedValidation(t):self.callbackname(t)},failedValidation:function(t){self=this;var a=t.errors;"login-form"==self.form.attr("id")?self.form.find("input[name = 'password']").after('<div class="mt10 alert alert-danger alert-dismissible" role="alert">'+a+'<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div>'):$.each(a,function(t,a){0==self.validationscroll&&(self.form.find("#"+t).focus(),$("html, body").animate({scrollTop:self.form.find("#"+t).offset().top-self.validationoffset},self.validationScrollSpeed),self.validationscroll=!0),self.form.find("#"+t).parent().addClass("has-error"),self.form.find("#"+t).parent().find(".glyphicon").remove(),self.form.find('input[name="'+t+'"]').parent().find(".help-block:visible").remove(),self.form.find("#"+t).after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+t+'" data-bv-result="INVALID">'+a+"</small>"),self.form.find("#"+t).after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+t+'" style="display: block;"></i>')}),self.renableButton()}};
var ImagePlaceholder=function(){this.colour="#ebedee",this.size=0,this.themes()};ImagePlaceholder.prototype={constructor:ImagePlaceholder,themes:function(){self=this,Holder.addTheme("upload",{background:self.colour,foreground:self.colour,size:self.size})}};
var PreviewClassBox=function(s){this.box=s,this.boxClass=s.attr("class"),this.id=s.attr("id")};
function Cart(t){this.cart=t,this.form="",this.maxQty="2000",this.addListeners(),$(".checkout").length&&(this.step=0,this.viewPrice=VIEWPRICE,this.checkout())}Cart.prototype={constructor:Cart,addListeners:function(){$(document).on("submit","#empty-cart",$.proxy(this.submit,this)),$(document).on("submit",".remove-row",$.proxy(this.submit,this)),$(document).on("submit",".add-to-class",$.proxy(this.submit,this)),$(document).on("change",".btn-select",$.proxy(this.changeSelectDropdown,this)),$(document).on("click",".toggle-select .switch a",$.proxy(this.switchQty,this)),$(document).on("click","#stripe-button",$.proxy(this.openStripe,this)),$(window).on("popstate",$.proxy(this.closeStripe,this)),$(document).on("change",'select[name="quantity"]',$.proxy(this.selectQty,this))},changeSelectDropdown:function(t){$(t.target).hasClass("qty-select")&&this.selectQty(t),$(t.target).hasClass("select-box")?$(t.target).closest(".add-to-class").trigger("submit"):$(t.target).val()?($(t.target).css("z-index",1),$(t.target).closest(".add-to-class").trigger("submit")):$(t.target).css("z-index",0)},switchQty:function(t){t.preventDefault(),t.stopPropagation();var e=$(t.target).closest(".toggle-select");this.maxQty=$(e).data("qty");var a=$(e).data("trigger"),i=$(t.target).attr("href").substring(1),n=$(e).find("#toggle-quantity").val();if("plus"==i){if(n<this.maxQty){var s=Math.max(parseInt(n)+1);$(e).find("#toggle-quantity").val(s),$(e).find("#qty").text(s)}}else if(n>1){var s=Math.max(parseInt(n)-1);$(e).find("#toggle-quantity").val(s),$(e).find("#qty").text(s)}a&&$(t.target).closest(".add-to-class").trigger("submit")},selectQty:function(t){var e=$(t.target).val();$(t.target).closest(".qty-wrapper").find(".qty-select").val(e)},submit:function(t){t.preventDefault(),t.stopPropagation(),this.form=$(t.target),this.ajaxSubmit()},ajaxSubmit:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find('input[type="submit"]').hasClass("add-btn")?t.form.find("input[type='submit']").prop("disabled",!0):t.form.find("input[type='submit']").replaceWith('<span id="cart-loading" class="icon icon-loading"></span>'),console.log($(".checkout .mask").length),$(".checkout .mask").length&&$(".mask").removeClass("hidden"),t.form.find(".switch").addClass("disabled")},success:function(e){e.view?(t.updateCart(e),$(".checkout .mask").length&&$(".checkout .mask").addClass("hidden")):e.refresh?location.reload():1==e.validation_failed&&(t.failedValidation(e),$(".mask").length&&$(".mask").addClass("hidden"))},error:function(t,e,a){console.log(t+" - "+e+" - "+a)},complete:function(){t.form.find("input[type=submit]").prop("disabled",!1),$("#cart-loading").remove(),t.form.find(".switch").removeClass("disabled")}})},updateCart:function(t){$(".cart-dropdown:visible").addClass("open"),$(".cart-dropdown.open .dropdown-cart").replaceWith(t.view),$(".cart-items").html(t.items)},failedValidation:function(t){$("body").append('<div class="mt10 alert alert-danger alert-dismissible fixed" >'+t.errors.custom+'<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div>')},checkout:function(){this.newUserForm=$(".checkout #new-user-form"),this.loginForm=$(".checkout .login-form"),this.userType="new";var t=this;$("#step-2").on("shown.bs.collapse",function(t){var e=$(t.target).attr("id");$('a[href="#'+e+'"]').addClass("hidden"),$("#step-1").find(".switch-cart").addClass("hidden"),$("#step-1").find(".switch-back").removeClass("hidden"),$(".cart-progress").find("#progress-2").addClass("complete")}),$(document).on("change",":checkbox",function(e){var a=$(e.target).attr("name");$(":checkbox").prop("checked",!1),$('input[name="'+a+'"]').prop("checked",!0),t.userType=a}),$(document).on("keyup",t.loginForm.find('input[name="email"]'),function(e){t.newUserForm.find('input[name="email"]').val($(e.target).val())}),$(document).on("click","#cart-account",function(e){e.preventDefault(),"new"==t.userType?t.newUserForm.trigger("submit"):t.loginForm.trigger("submit")}),$(document).on("submit",t.newUserForm,$.proxy(this.newUser,this))},openStripe:function(t){var e=this;handler.open({name:"Evercise",description:"Checkout",amount:e.viewPrice}),t.preventDefault()},closeStripe:function(){handler.close()},newUser:function(t){t.preventDefault();var e=this;console.log(e.loginForm.find('input[name="email"]').val()),e.newUserForm.find('input[name="email"]').val(e.loginForm.find('input[name="email"]').val()),$.ajax(e.newUserForm.attr("action"),{type:"post",data:e.newUserForm.serialize(),dataType:"json",beforeSend:function(){$(".has-error").removeClass("has-error"),$(".error-append").remove(),e.newUserForm.find("input[type='submit']").prop("disabled",!0)},success:function(t){1==t.validation_failed?e.failedValidation(t):location.reload()},error:function(t,e,a){console.log(t+" - "+e+" - "+a)},complete:function(){e.newUserForm.find("input[type=submit]").prop("disabled",!1)}})},failedValidation:function(t){var e=this,a=t.errors;$.each(a,function(t,a){e.loginForm.find('input[name="'+t+'"]').parent().addClass("has-error").after('<div class="form-control input-lg input-group has-error error-append">'+a+"</div>")})}};


"undefined"!=typeof angular&&app.controller("browseController",["$scope","$http",function(e,o){angular.element(document).ready(function(){e.getCats()}),e.activeCatSwitch=function(o){e.activeCat=o},e.subCategories=function(o,t){o.preventDefault(),e.browse=t,e.browseIsVisible=!0},e.closeBrowse=function(){e.browseIsVisible=!1},e.getCats=function(){var t="/ajax/categories/browse",n={method:"POST",url:t,headers:{"X-CSRF-Token":TOKEN}},s=o(n);s.success(function(o){e.categories=o,console.log(e.categories)}),s.error(function(e){console.log("AJAX failed!"),console.log(e)})}}]);
"undefined"!=typeof angular&&(app.controller("DiscoverController",["$scope","$q",function(e){function t(e){$(".class-snippet").addClass("fade-out"),$(".class-snippet").removeClass("active"),$(e).addClass("active"),$(".mb-scroll").mCustomScrollbar("scrollTo",e,{scrollInertia:500,timeout:10})}e.everciseGroups=laracasts.mapResults,e.results=e.everciseGroups.length,e.sort="-score",e.dropwdownStyle={top:0,left:0},e.active={},e.originalDistance=parseInt($('select[name="distance"]').val()),e.maxDistance=parseInt($('select[name="distance"]').val()),e.myMarkers=[],e.markers=[];var i=function(t){var i={id:t.id,name:t.name,directory:t.user.directory,image:t.image,latitude:t.venue.lat,longitude:t.venue.lng,coords:{latitude:t.venue.lat,longitude:t.venue.lng},icon:"/assets/img/icon_default_small_pin.png",price:t.default_price,rating:t.ratings.length,reviews:t.ratings,description:t.description,stars:e.getStars(t.ratings),capacity:t.capacity,sessions:t.futuresessions,distance:t.distance,score:t.score,nextClassDate:t.futuresessions[0].date_time,nextClassDuration:t.futuresessions[0].duration,link:"/classes/"+t.slug,click:function(){e.clicked(this.model)}};return i};e.distanceFilter=function(t){return t.distance<=e.maxDistance||t==e.active?t:void 0},e.toggle=function(t,i){var s=$(t.target),n=s.offset(),r=1.5*s.height();e.dropwdownStyle={top:n.top+r,left:n.left},$(t.target).parent().hasClass("active")&&window.setTimeout(function(){$("#"+i).removeClass("active"),$(t.target).parent().removeClass("active")},1)},$(document).mouseup(function(e){var t=$(".custom-dropdown");t.parent().hasClass("active")&&(t.is(e.target)||0!==t.has(e.target).length||($(".sort-btn").removeClass("active"),$(".filter-btn").removeClass("active"),$(".tab-pane-sort").removeClass("active")))}),e.closeDropdown=function(t){window.setTimeout(function(){$(".tab-pane-sort").removeClass("active"),$("."+t+"-btn").removeClass("active")},1),window.setTimeout(function(){"undefined"!=typeof e.lastActiveMarker.id?$(".mb-scroll").mCustomScrollbar("scrollTo","#"+e.lastActiveMarker.id,{scrollInertia:500,timeout:10}):$(".mb-scroll").mCustomScrollbar("scrollTo","1px",{scrollInertia:500,timeout:10})},100)},e.setDistance=function(t,i){t.preventDefault(),e.maxDistance=i},e.changeView=function(t){e.view=t},e.isPreviewOpen=!1,e.returnPreview=function(){e.isPreviewOpen=!1},e.map={center:{latitude:50,longitude:-.2},pan:{},options:{streetViewControl:!1,maxZoom:19,minZoom:3},zoom:12},e.clusterStyles=[{textColor:"white",url:"/assets/img/icon_default_small_pin_number.png",height:43,width:33,anchorText:[-14,9]}],e.clusterOptions={gridSize:8,maxZoom:15,zoom:15,styles:e.clusterStyles},e.clusterEvents={click:function(t,i){angular.forEach(i,function(t){e.clicked(t)})}},e.mask=!1,e.initialLoad=e.everciseGroups.length<200?e.everciseGroups.length:200,e.lastActiveMarker="",e.clicked=function(i){e.active=i,e.distanceFilter(i),e.isPreviewOpen=!0,e.preview.id="preview-"+i.id,e.preview.name=i.name,e.preview.image=i.directory+"/preview_"+i.image,e.preview.description=i.description,e.preview.nextClassDate=i.sessions[0].date_time,e.preview.nextClassDuration=i.sessions[0].duration,e.preview.capacity=i.capacity,e.preview.link=i.link,e.preview.sessions=i.sessions,e.preview.reviews=i.reviews,e.lastActiveMarker.icon="/assets/img/icon_default_small_pin.png",e.lastActiveMarker=i,i.icon="/assets/img/icon_default_large_pink.png",e.mask=!0,google.maps.event.trigger(e.map,"resize"),e.map.center={latitude:i.latitude,longitude:i.longitude},e.map.zoom=15,e.mask=!0,t("#"+i.id),0==e.preview.sessions.length&&$("#preview-"+i.id).find('a[href="about"]').trigger("click")},e.getStars=function(e){var t=0;if(e.length>0){for(var i=0;i<e.length;i++)t+=e[i].stars;result=Math.round(t/e.length)}else result=0;return result},e.hasTickets=function(e){return e.remaining>0?!0:!1},e.view=window.innerWidth>=992?"mapview":window.innerWidth>=767?"listview":"gridview",$(window).resize(function(){window.innerWidth<992&&window.innerWidth>=767?e.$apply(function(){e.view="listview"}):window.innerWidth<767&&e.$apply(function(){e.view="gridview"})}),e.$watch(function(){return e.map.bounds},function(){for(var t=0;t<e.initialLoad;t++)e.myMarkers.push(i(e.everciseGroups[t]));e.markers=e.myMarkers,e.scrollHeight()},!0),e.scrollHeight=function(){return e.windowHeight=$(document).height(),e.navHeight=$("#nav").outerHeight(),e.searchHeight=$(".discover-nav").outerHeight(),e.filterHeight=104,e.scrollBarHeight=e.windowHeight-e.navHeight-e.searchHeight-e.filterHeight,{height:e.scrollBarHeight+"px"}},$(window).resize(function(){e.$apply(function(){e.scrollHeight()})}),e.preview={id:1,description:"",nextClassDate:"",nextClassDuration:"",capacity:"",link:""}}]),app.directive("backImg",function(){return function(e,t,i){i.$observe("backImg",function(e){t.css({background:"url("+e+")"})})}}));
"undefined"!=typeof angular&&app.controller("calendarController",["$scope",function(e){function t(t){for(var a=0;a<e.rows.length;a++)if(e.rows[a].id==t)return!0;return!1}e.sessions=JSON.parse($('input[name="sessions"]').val()),e.rows=[],e.activeDate,e.cartItems=JSON.parse(CART),$("#class-calendar").datepicker({format:"yyyy-mm-dd",startDate:"+1d",weekStart:1,multidate:!1,beforeShowDay:function(a){var r=a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2),n=$.grep(e.sessions,function(e){var t=e.date_time;return t=t.split(/\s+/),t[0]==r});if(n.length>0){for(var s in n){if(!t(n[s].id)){var i=new Date(n[s].date_time.replace(/\s+/,"T"));e.rows.push({id:n[s].id,date:i,price:n[s].price,remaining:n[s].remaining,default_tickets:n[s].default_tickets,selected:e.cartItems[n[s].id],show:!1})}console.log(i)}return{enabled:!0,classes:"session"}}return{enabled:!1,classes:!1}}}).on("changeDate",function(t){e.activeDate=t.date,e.$apply(),$(".select-box").selectbox()}),e.activeFilter=function(t){if("undefined"!=typeof e.activeDate){var a=t.date;return a.setHours(0,0,0,0),a.toString()==e.activeDate.toString()}}}]);
"undefined"!=typeof angular&&app.controller("searchController",["$scope","$http","uiGmapGoogleMapApi",function(e,t){e.groupHeight=function(){var e=$(window).width();if(e>992){var t=$(".results").outerHeight(),s=$(".results .heading").outerHeight(),n=$(".results .nav-tabs").outerHeight(),a=$(".results .date-picker-inline").outerHeight(),r=t-s-n-a;return{height:r+"px"}}return{height:"auto"}},e.results=laracasts.results,console.log(e.results),e.resultsLoading=!1,e.mapOptions={disableDefaultUI:!0,zoomControl:!0,backgroundColor:"#383d48",panControl:!1},e.clusterStyles=[{textColor:"white",url:"/assets/img/icon_default_small_pin_number.png",height:43,width:33,anchorText:[-14,9]}],e.clusterOptions={title:"click to expand",gridSize:5,maxZoom:20,styles:e.clusterStyles,zoomOnClick:!1},e.markerEvents={click:function(t,n,a){e.selectedVenueIds=!1,e.lastActiveMarker.icon="/assets/img/icon_default_small_pin.png",e.lastActiveMarker=a,a.icon="/assets/img/icon_default_large_pink.png",s(a),setTimeout(function(){$(".mb-scroll").mCustomScrollbar("scrollTo",$("#group-"+a.id),{scrollInertia:500,timeout:20})},500)},mouseover:function(e,t,s){$("#venue-"+s.id).addClass("active")},mouseout:function(e,t,s){$("#venue-"+s.id).removeClass("active")}},e.selectedVenueIds=!1,e.selectedVenueName=!1,e.clusterEvents={click:function(t,s){e.selectedVenueIds=!1;var n=t.getCenter(),a=e.map.control.getGMap(),r=new google.maps.LatLng(n.lat(),n.lng());a.panTo(r);var l=[];angular.forEach(s,function(e){l.push(e.id)}),e.selectedVenueIds=l,e.selectedVenueName=s[0].venue.name,e.lastActiveMarker.icon="/assets/img/icon_default_small_pin.png",e.lastActiveMarker=t},mouseover:function(e,t){angular.forEach(t,function(e){$("#venue-"+e.id).addClass("active")})},mouseout:function(e,t){angular.forEach(t,function(e){$("#venue-"+e.id).removeClass("active")})}},e.radius=e.results.radius,e.map={zoom:12,maxZoom:18,center:{latitude:e.results.area.lat,longitude:e.results.area.lng},control:{},clusterOptions:e.clusterOptions},e.mapEvents={},e.lastActiveMarker={},shapeEverciseGroups=function(){var t=[];return angular.forEach(e.results.results.hits,function(e){t.push({id:e.id,name:e.name,icon:"/assets/img/icon_default_small_pin.png",venue:{id:e.id,name:e.venue.name,postcode:e.venue.postcode,latitude:e.venue.lat,longitude:e.venue.lng},slug:e.slug,times:e.times,price:e.default_price})}),console.log(t),t},e.everciseGroups=shapeEverciseGroups();var s=function(t){var s=e.map.control.getGMap(),n=new google.maps.LatLng(t.venue.latitude,t.venue.longitude);s.panTo(n)};e.scrollWidth=function(){var t=$(".date-picker-inline li .day").outerWidth(),s=Object.keys(e.results.available_dates).length;return{width:t*s+"px"}},e.scroll_clicked=!1,e.scrollDates=function(t,s){s.preventDefault(),e.scroll_clicked=!0;var n=$(s.target).parent(),a=n.width(),r=n.find(".content"),l=parseInt(r.css("margin-left")),o=-r.width();if("right"==t)var i=l-a;else var i=l+a;0>=i&&i>=o&&n.find(".content").css({"margin-left":i+"px"}),setTimeout(function(){e.scroll_clicked=!1},500)},e.selectedDate=e.results.selected_date,e.changeSelectedDate=function(t,s){t.preventDefault(),e.selectedDate=s,e.getData()},$(".filter-btn, .sort-btn").click(function(e){e.preventDefault(),n($(this))});var n=function(e){e.parent("li").hasClass("active")&&window.setTimeout(function(){$(".tab-pane").removeClass("active"),e.parent("li").removeClass("active")},1)};e.sortChanged=function(t,s){t.preventDefault(),e.results.sort=s,e.getData()},e.url=e.results.url,e.getData=function(){var s="/ajax/uk/",a={method:"POST",url:s+e.url,headers:{"X-CSRF-Token":TOKEN},data:{date:e.selectedDate,radius:e.results.radius,sort:e.results.sort}},r=t(a);n($(".filter-btn, .sort-btn")),e.resultsLoading=!0,r.success(function(t){e.results=t,e.selectedDate=e.results.selected_date,e.everciseGroups=shapeEverciseGroups(),e.resultsLoading=!1;var s=e.map.control.getGMap();s.setZoom(12)}),r.error(function(t){console.log("AJAX failed!"),console.log(t),e.resultsLoading=!1})},e.$watch(function(){return window.innerWidth},function(t){e.width=t})}]);