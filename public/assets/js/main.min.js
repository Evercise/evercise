function redirectTo(i){window.location.href=i.url}function editClass(i){$("#"+i.id).html(i.view),$("#edit-"+i.id).removeClass("disabled"),$("#submit-"+i.id).hide(),$("#"+i.id).parent().collapse("show"),$("#infoToggle-"+i.id).removeClass("hide"),datepick()}function updateHubRow(i){$("#hub-edit-row-"+i.id).after(i.view)}function newSessionAdded(i){$("#"+i.id).html(i.view),datepick()}function removeSessionRow(i){$("#hub-edit-row-"+i.id).fadeOut(400)}
if("undefined"!=typeof angular){var app=angular.module("DiscoverApp",["google-maps".ns()],["$interpolateProvider",function(n){n.startSymbol("{[{"),n.endSymbol("}]}")}]);app.config(["GoogleMapApiProvider".ns(),function(n){n.configure({v:"3.16",libraries:"places"})}]),app.filter("truncate",function(){return function(n,r,e){return isNaN(r)&&(r=10),void 0===e&&(e="..."),n.length<=r||n.length-e.length<=r?n:String(n).substring(0,r-e.length)+e}}),app.filter("repeat",function(){return function(n,r){r=parseInt(r);for(var e=0;r>e;e++)n.push(e);return n}})}
function datepick(){$(".date-picker").datepicker({format:"yyyy-mm-dd",startDate:"+2d",autoclose:!0,todayHighlight:!0})}$.fn.exists=function(t){var a=[].slice.call(arguments,1);return this.length&&t.call(this,a),this};
$.ajaxSetup({headers:{"X-CSRF-Token":TOKEN}}),$(function(){$(".navbar").exists(function(){new Navigation(this,$(".hero-nav-change"))}),$(".masonry").exists(function(){new Masonry(this)}),$(".toggle-switch").exists(function(){$(document).on("click",".toggle-switch",function(e){new ToggleSwitch($(e.target))})}),$(".map_canvas").exists(function(){map=new Map(this)}),$(".lazy").exists(function(){$("img.lazy").lazyload()}),$(".mb-scroll").exists(function(){function e(){$("img.lazy").lazyload()}$(this).mCustomScrollbar({scrollSpeed:50,mouseWheelPixels:50,autoHideScrollbar:!0,scrollInertia:0,callbacks:{onScroll:function(){e()}}})}),$(".holder").exists(function(){new ImagePlaceholder}),$("#register-form").exists(function(){new registerUser(this)}),$("#register-trainer").exists(function(){new registerTrainer(this)}),$(".class-preview").exists(function(){new PreviewClassBox(this)}),$(".hide-by-class").exists(function(){var e=0;$(".hide-by-class").each(function(){var s=this;$("."+$(this).attr("href").substr(1)).exists(function(){0==e&&($(s).addClass("active"),$(s).parent().removeClass("hidden-mob"),$(this).removeClass("hide")),$(s).removeClass("disabled"),e++})}),this.click(function(){$(".hide-by-class").removeClass("active"),$(this).addClass("active"),$(".hide-by-class-element").addClass("hide"),$("."+$(this).attr("href").substr(1)).removeClass("hide")})}),$(".login-form").exists(function(){new Login(this)}),$(".edit-class-inline").exists(function(){new EditClass(this),$(document).on("submit",".add-session",function(e){e.preventDefault(),new AjaxRequest($(e.target),newSessionAdded)})}),$(document).on("submit",".remove-session",function(e){e.preventDefault(),new AjaxRequest($(e.target),removeSessionRow)}),$(".dropdown-cart").exists(function(){cart=new Cart(this)}),$("#find_gallery_image_by_category").exists(function(){new categorySelect($(this))}),$("#image-cropper").exists(function(){new imageCropper(this)}),$("#create-venue").exists(function(){new createVenue(this)}),$("#add-session").exists(function(){new AddSessionsToCalendar(this)}),$("#update-sessions").exists(function(){new UpdateSessions(this)}),$("#create-class").exists(function(){new createClass(this)}),$("#preview").exists(function(){new previewBox(this)}),$("#publish-class").exists(function(){new publishClass(this)}),$("#register-fb").exists(function(){new facebookRedirect(this)}),$("#scroll-to").exists(function(){new scrollTo(this)}),$("#profile-nav").exists(function(){new profileNav(this)}),$(".rate-it").exists(function(){new RateIt(this)}),$("#add-topup").exists(function(){new topUp(this)}),$("#location-auto-complete").exists(function(){autocomplete=new LocationAutoComplete(this)}),$("#checkout").exists(function(){new checkout(this)}),$("#voucher").exists(function(){new voucher(this)}),$("#refer-a-friend").exists(function(){new Referral(this)}),$("#update-user-form").exists(function(){new updateProfile(this)}),$("#list-accordion").exists(function(){new listAccordion(this)}),$("#hero-carousel , #image-carousel").exists(function(){$(this).carousel({interval:4e3})}),$(".mail-popup").exists(function(){new MailPopup(this)}),$("#withdraw-funds").exists(function(){new Withdrawal(this)}),$(".remove-session").exists(function(){new RemoveSession(this)})});
var Validation=function(a){this.form=a,this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.displayName={message:"Your username is not valid",validators:{notEmpty:{message:"Your display name is required"},stringLength:{min:5,max:20,message:"Your display name must be more than 5 and less than 20 characters long"},regexp:{regexp:/^[a-zA-Z0-9_]+$/,message:"Your display name can only consist of alphabetical, number and underscore"}}},this.email={validators:{notEmpty:{message:"Your email is required and cannot be empty"},emailAddress:{message:"Your email is not a valid email address"}}},this.first_name={validators:{notEmpty:{message:"Your first name is required and cannot be empty"},stringLength:{min:2,max:15,message:"Your first name must be more than 2 and less than 15 characters long"}}},this.last_name={validators:{notEmpty:{message:"Your surname is required and cannot be empty"},stringLength:{min:2,max:15,message:"Your surname must be more than 2 and less than 15 characters long"}}},this.password={validators:{notEmpty:{message:"Your password is required and cannot be empty"},stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"confirmed_password",message:"Your passwords do not match"}}},this.confirmed_password={validators:{notEmpty:{message:"Your password is required and cannot be empty"},stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"password",message:"Your passwords do not match"}}},this.init()};Validation.prototype={constructor:Validation,init:function(){this.form.find("input[type='submit']").prop("disabled",!0),this.validation()},validation:function(){this.form.bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{display_name:this.displayName,email:this.email,first_name:this.first_name,last_name:this.last_name,password:this.password,confirmed_password:this.confirmed_password}}).on("success.form.bv",function(a){a.preventDefault(),new AjaxRequest($(a.target),redirectTo)})}};
"undefined"!=typeof angular&&app.controller("DiscoverController",["$scope","$q",function(e){function i(e){$(".class-snippet").addClass("fade-out"),$(".class-snippet").removeClass("active"),$(e).addClass("active"),$(".mb-scroll").mCustomScrollbar("scrollTo",e,{scrollInertia:500,timeout:10})}e.everciseGroups=laracasts.mapResults,e.results=e.everciseGroups.length,e.sort="id",e.dropwdownStyle={top:0,left:0},e.active={},e.originalDistance=parseInt($('select[name="distance"]').val()),e.maxDistance=parseInt($('select[name="distance"]').val()),e.myMarkers=[],e.markers=[];var t=function(i){var t={id:i.id,name:i.name,directory:i.user.directory,image:i.image,latitude:i.venue.lat,longitude:i.venue.lng,coords:{latitude:i.venue.lat,longitude:i.venue.lng},icon:"/assets/img/icon_default_small_pin.png",price:i.default_price,rating:i.ratings.length,reviews:i.ratings,description:i.description,stars:e.getStars(i.ratings),capacity:i.capacity,sessions:i.futuresessions,distance:i.distance,nextClassDate:i.futuresessions[0].date_time,nextClassDuration:i.futuresessions[0].duration,link:"/classes/"+i.slug,click:function(){e.clicked(this.model)}};return t};e.distanceFilter=function(i){return i.distance<=e.maxDistance||i==e.active?i:void 0},e.toggle=function(i,t){var n=$(i.target).offset(),s=1.5*$(i.target).height();e.dropwdownStyle={top:n.top+s,left:n.left},$(i.target).parent().hasClass("active")&&window.setTimeout(function(){$("#"+t).removeClass("active"),$(i.target).parent().removeClass("active")},1)},e.closeDropdown=function(i){window.setTimeout(function(){$(".tab-pane-sort").removeClass("active"),$("."+i+"-btn").removeClass("active")},1),window.setTimeout(function(){$(".mb-scroll").mCustomScrollbar("scrollTo","#"+e.lastActiveMarker.id,{scrollInertia:500,timeout:10})},100)},e.setDistance=function(i,t){i.preventDefault(),e.maxDistance=t},e.changeView=function(i){e.view=i},e.isPreviewOpen=!1,e.returnPreview=function(){e.isPreviewOpen=!1},e.map={center:{latitude:50,longitude:-.2},pan:{},options:{streetViewControl:!1,maxZoom:19,minZoom:3},zoom:12},e.clusterStyles=[{textColor:"white",url:"/assets/img/icon_default_small_pin_number.png",height:43,width:33,anchorText:[-14,9]}],e.clusterOptions={gridSize:8,maxZoom:15,zoom:15,styles:e.clusterStyles},e.clusterEvents={click:function(i,t){angular.forEach(t,function(i){e.clicked(i)})}},e.mask=!1,e.initialLoad=e.everciseGroups.length<200?e.everciseGroups.length:200,e.lastActiveMarker="",e.clicked=function(t){e.active=t,e.distanceFilter(t),e.isPreviewOpen=!0,e.preview.id="preview-"+t.id,e.preview.name=t.name,e.preview.image=t.directory+"/preview_"+t.image,e.preview.description=t.description,e.preview.nextClassDate=t.sessions[0].date_time,e.preview.nextClassDuration=t.sessions[0].duration,e.preview.capacity=t.capacity,e.preview.link=t.link,e.preview.sessions=t.sessions,e.preview.reviews=t.reviews,e.lastActiveMarker.icon="/assets/img/icon_default_small_pin.png",e.lastActiveMarker=t,t.icon="/assets/img/icon_default_large_pin_pink.png",e.mask=!0,google.maps.event.trigger(e.map,"resize"),e.map.center={latitude:t.latitude,longitude:t.longitude},e.map.zoom=15,e.mask=!0,i("#"+t.id),0==e.preview.sessions.length&&$("#preview-"+t.id).find('a[href="about"]').trigger("click")},e.getStars=function(e){var i=0;if(e.length>0){for(var t=0;t<e.length;t++)i+=e[t].stars;result=Math.round(i/e.length)}else result=0;return result},e.preview={id:1,image:"",description:"",nextClassDate:"",nextClassDuration:"",capacity:"",link:""},e.hasTickets=function(e){return e.remaining>0?!0:!1},e.view=window.innerWidth>=1200?"mapview":window.innerWidth>=767?"listview":"gridview",$(window).resize(function(){window.innerWidth<1200&&window.innerWidth>=767?e.$apply(function(){e.view="listview"}):window.innerWidth<767&&e.$apply(function(){e.view="gridview"})}),e.$watch(function(){return e.map.bounds},function(){for(var i=0;i<e.initialLoad;i++)e.myMarkers.push(t(e.everciseGroups[i]));e.markers=e.myMarkers,$("img.lazy").lazyload({container:$(".snippet-body")}),e.scrollHeight()},!0),e.scrollHeight=function(){return e.windowHeight=$(document).height(),e.navHeight=$("#nav").outerHeight(),e.searchHeight=$(".discover-nav").outerHeight(),e.filterHeight=104,e.scrollBarHeight=e.windowHeight-e.navHeight-e.searchHeight-e.filterHeight,console.log(e.windowHeight),{height:e.scrollBarHeight+"px"}},$(window).resize(function(){e.$apply(function(){e.scrollHeight()})})}]);
var Navigation=function(o,s){this.nav=o,this.hero=s,this.height=o.height(),this.heroClass="nav-hero",this.scroll=0,this.init()};Navigation.prototype={constructor:Navigation,init:function(){this.hero.length>0&&(this.addHeroClass(),this.checkScrollPosition())},addHeroClass:function(){this.nav.addClass(this.heroClass)},removeHeroClass:function(){this.nav.removeClass(this.heroClass)},checkScrollPosition:function(){var o=this;$(window).scroll(function(){o.scroll=$(window).scrollTop(),o.scroll+o.height>=o.hero.outerHeight()?o.removeHeroClass():o.addHeroClass()})}};
function imageCropper(i){this.elem=i,this.modal=this.elem.find(".modal-cropper"),this.modalImage=this.modal.find("#uploaded-image"),this.uploadForm=this.elem.find("#image-upload-form"),this.galleryRow=$("#gallery-row"),this.galleryImage="",this.galleryValue="",this.croppedForm=this.modal.find("#cropped-image"),this.uploadButton=this.modal.find("input[name='file']"),this.imageSelect=this.uploadForm.find(".image-select"),this.image=this.modal.find(".bootstrap-modal-cropper img"),this.xInput=this.modal.find("input[name='x']"),this.yInput=this.modal.find("input[name='y']"),this.wInput=this.modal.find("input[name='width']"),this.hInput=this.modal.find("input[name='height']"),this.bwInput=this.modal.find("input[name='box_width']"),this.bhInput=this.modal.find("input[name='box_height']"),this.originalData={},this.ratio=this.modal.data("ratio")?this.modal.data("ratio"):2.35,this.imageType=2.35==this.ratio?"/cover_":"/medium_",this.x=0,this.y=0,this.w=0,this.h=0,this.bw=0,this.bh=0,this.init()}imageCropper.prototype={constructor:imageCropper,init:function(){this.addListener(),""!=$('input[name="cloned"]').val()&&(this.galleryImage='<img src="/'+$('input[name="cloned"]').val()+'"  alt="cover photo" class="img-responsive">')},addListener:function(){$(document).on("click",".image-select",$.proxy(this.upload,this)),this.uploadButton.on("change",$.proxy(this.getImage,this)),this.galleryRow.on("change",$.proxy(this.updatedRow,this)),this.modalImage.on("load",$.proxy(this.openModal,this)),this.modal.on("shown.bs.modal",$.proxy(this.crop,this)),this.modal.on("hidden.bs.modal",$.proxy(this.destroyCrop,this)),this.croppedForm.on("submit",$.proxy(this.submitForm,this)),$(document).on("click",".gallery-option",$.proxy(this.clickGalleryOption,this))},upload:function(){this.uploadButton.trigger("click")},getImage:function(i){if(self=this,i.target.files&&i.target.files[0]){var t=new FileReader;t.onload=function(i){self.modalImage.attr("src",i.target.result)},t.readAsDataURL(i.target.files[0])}},openModal:function(){this.modal.modal("show")},closeModal:function(){this.modal.modal("hide")},crop:function(){self=this,this.image=this.modal.find(".bootstrap-modal-cropper img"),this.image.cropper({data:this.originalData,aspectRatio:this.ratio,done:function(i){self.x=i.x,self.y=i.y,self.w=i.width,self.h=i.height}})},destroyCrop:function(){this.image.cropper("destroy"),self.modalImage.attr("src",null),this.uploadButton.val("")},submitForm:function(i){i.preventDefault(),this.bw=this.image.cropper("getImageData").width,this.bh=this.image.cropper("getImageData").height,this.xInput.val(this.x),this.yInput.val(this.y),this.wInput.val(this.w),this.hInput.val(this.h),this.bwInput.val(this.bw),this.bhInput.val(this.bh),this.ajaxUpload()},ajaxUpload:function(){var i=this.croppedForm.attr("action"),t=new FormData(this.croppedForm[0]),a=this;$.ajax(i,{type:"post",data:t,processData:!1,contentType:!1,beforeSend:function(){a.croppedForm.find("input[type='submit']").prop("disabled",!0).after('<span id="cropping-loading" class="icon icon-loading ml10"></span>'),a.image.cropper("disable")},success:function(i){a.galleryValue=i.filename,a.galleryImage='<img src="/'+i.folder+a.imageType+i.filename+'" alt="cover photo" class="img-responsive">',a.croppedForm.find("input[type=submit]").prop("disabled",!1),a.uploadForm.append(a.galleryImage),$("#first-img")&&($("#first-img").html(a.galleryImage),$("#first-img").append('<div class="holder-add-more"><span class="image-select icon-lg icon-md-camera hover"></span>')),$('input[name="gallery_image"]').length&&$('input[name="gallery_image"]').val(!1),$('input[name="image"]').val(a.galleryValue).trigger("change")},error:function(i,t,a){console.log(i+" - "+t+" - "+a)},complete:function(){$("#cropping-loading").remove(),a.closeModal()}})},clickGalleryOption:function(i){this.galleryValue=$(i.target).data("id"),this.uploadForm.append('<img src="'+$(i.target).data("large")+'" alt="cover image" class="img-responsive">'),$('input[name="image"]').val(this.galleryValue).trigger("change"),$('input[name="gallery_image"]').length&&$('input[name="gallery_image"]').val(!0)},updatedRow:function(){""!=this.galleryImage&&'<img src="/undefined"  alt="cover photo" class="img-responsive">'!=this.galleryImage&&($("#first-img").html(this.galleryImage),$("#first-img").append('<div class="holder-add-more"><span class="image-select icon-lg icon-md-camera hover"></span>'))}};
function createVenue(e){this.container=e,this.form=e.find("#create_venue"),this.next=this.form.find(".next"),this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.venueName={message:"Your Venue is not valid",validators:{notEmpty:{message:"Your Venue requires a name"},stringLength:{min:2,max:50,message:"Your Venue name must be more than 2 and less than 50 characters long"}}},this.venueStreet={message:"Your street is not valid",validators:{notEmpty:{message:"Your Venue requires a street"},stringLength:{min:2,max:50,message:"Your street name must be more than 2 and less than 50 characters long"}}},this.town={message:"Your town is not valid",validators:{notEmpty:{message:"Your Venue requires a town"},stringLength:{min:2,max:50,message:"Your town name must be more than 2 and less than 50 characters long"}}},this.venuePC={message:"Your post code is not valid",validators:{notEmpty:{message:"Your Venue requires a post code"},stringLength:{min:6,max:8,message:"Your post code must be more than 6 and less than 8 characters long"}}},this.init()}createVenue.prototype={constuctor:createVenue,init:function(){this.addListener(),this.validation(),this.form.find("input[type='submit']").prop("disabled",!0)},addListener:function(){this.next.on("click",$.proxy(this.switchTab,this))},switchTab:function(e){e.preventDefault();var n=$(e.target).data("target");$("#"+n+"-pill").click()},validation:function(){var e=this;$(this.form).bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{name:this.venueName,address:this.venueStreet,town:this.town,postcode:this.venuePC}}).on("success.form.bv",function(n){n.preventDefault(),e.ajaxUpload()})},ajaxUpload:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){e.form.find("input[type='submit']").prop("disabled",!0).after('<span id="venue-loading" class="icon icon-loading ml10"></span>')},success:function(n){1==n.validation_failed?e.failedValidation(n):(e.container.modal("hide"),e.form.find("input[type=submit]").prop("disabled",!1),$("#venue_select").append($("<option />",{text:n.venue_name,value:n.venue_id,selected:!0})))},error:function(e,n,t){console.log(e+" - "+n+" - "+t)},complete:function(){$("#venue-loading").remove()}})},failedValidation:function(e){console.log(e),self=this;var n=e.errors;$("#venue-pill").trigger("click"),$.each(n,function(e,n){console.log(e),self.form.find('input[name="'+e+'"]').parent().addClass("has-error"),self.form.find('input[name="'+e+'"]').parent().find(".glyphicon").remove(),self.form.find('input[name="'+e+'"]').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+e+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+e+'" data-bv-result="INVALID">'+n+"</small>"),self.form.find('input[name="'+e+'"]').after('<i class="form-control-feedback bv-no-label glyphicon glyphicon-remove" data-bv-icon-for="'+e+'"></i>')})}};
function categorySelect(e){this.form=e,this.select=this.form.find(".select2"),this.keywordSelect=this.form.find('input[name="keywords"]'),this.keywords=[],this.keys=[],this.gallery="",this.maximumSelectionSize=3,this.minimumResultsForSearch=1,this.placeholder="Choose upto 3 categories",this.dropdownCssClass="select2-hidden",this.init()}categorySelect.prototype={constructor:categorySelect,init:function(){this.select.select2({maximumSelectionSize:this.maximumSelectionSize,minimumResultsForSearch:this.minimumResultsForSearch,placeholder:this.placeholder,closeOnSelect:!0,openOnEnter:!1,formatNoMatches:function(){return""},dropdownCssClass:this.dropdownCssClass}),this.addListener()},addListener:function(){this.form.on("submit",$.proxy(this.submitForm,this)),this.select.on("select2-selecting",$.proxy(this.addToKeywords,this)),this.select.on("select2-removing",$.proxy(this.removeFromKeywords,this)),$(document).on("swiperight","#image-carousel",function(){$(this).carousel("next")}),$(document).on("swipeleft","#image-carousel",function(){$(this).carousel("prev")})},submitForm:function(e){e.preventDefault(),this.ajaxUpload()},ajaxUpload:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){$("#gallery-row").after('<div id="gallery-loading"  class="alert alert-success text-center"><span class="icon icon-loading ml10"></span> Loading gallery based on your selected categories...</div>')},success:function(t){e.gallery=t.view,$("#gallery-row").html(e.gallery).trigger("change")},error:function(e,t,s){console.log(e+" - "+t+" - "+s)},complete:function(){e.select.prop("disabled",!1),$("#gallery-loading").remove()}})},addToKeywords:function(e){this.keys.push(e.choice.id),this.keywords.push(e.choice.text),this.keywordSelect.val(this.keywords),this.updateCategoriesInput(),this.form.submit()},removeFromKeywords:function(e){this.keywords=$.grep(this.keywords,function(t){return t!=e.choice.text}),this.keys=$.grep(this.keys,function(t){return t!=e.choice.id}),this.updateCategoriesInput()},updateCategoriesInput:function(){$('input[name="category_array[]"]').val(this.keys).trigger("change")}};
function createClass(a){this.form=a,this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.className={validators:{notEmpty:{message:"Your class name is required"},stringLength:{min:3,max:50,message:"Your class name must be more than 3 and less than 50 characters long"}}},this.classDescription={validators:{notEmpty:{message:"Your class needs a description"},stringLength:{min:50,max:500,message:"Your class description must be more than 50 and less than 500 characters long"}}},this.init()}createClass.prototype={constructor:createClass,init:function(){this.validation(),this.addListener()},addListener:function(){$(document).on("change",'input[name="image"]',$.proxy(this.reValidate,this)),$(document).on("change",'input[name="category_array[]"]',$.proxy(this.reValidate,this))},validation:function(){var a=this;$(this.form).on("init.form.bv",function(a,t){t.bv.disableSubmitButtons(!0)}).bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{class_name:this.className,class_description:this.classDescription}}).on("success.field.bv",function(){$("input[name='image']").val()||$("input[name='category_array[]']").val()||a.form.find("input[type='submit']").prop("disabled",!0)}).on("success.form.bv",function(t){t.preventDefault(),$("input[name='image']").val()?$("input[name='category_array[]']").val()?(a.form.find("input[type='submit']").prop("disabled",!1),a.ajaxUpload()):a.form.find("input[type='submit']").parent().parent().before('<div data-dismiss="alert" class="alert alert-danger">You must select at least one category before you can proceed<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span></button></div>'):a.form.find("input[type='submit']").parent().parent().before('<div data-dismiss="alert" class="alert alert-danger">You must add a cover image before you can proceed<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span></button></div>')})},ajaxUpload:function(){var a=this;$.ajax(a.form.attr("action"),{type:"post",data:a.form.serialize(),dataType:"json",beforeSend:function(){a.form.find("input[type='submit']").prop("disabled",!0).after('<span id="class-loading" class="icon icon-loading ml10"></span>')},success:function(t){1==t.validation_failed?(a.failedValidation(t),console.log(t)):window.location.href=t.url},error:function(a,t,e){console.log(a+" - "+t+" - "+e)},complete:function(){$("#class-loading").remove()}})},reValidate:function(){$("input[name='image']").val()&&$("input[name='category_array[]']").val()&&this.form.find("input[type='submit']").prop("disabled",!1)},failedValidation:function(a){var t=this,e=a.errors;$.each(e,function(a,e){"venue_select"==a?(t.form.find("#venue_select").parent().parent().addClass("has-error"),t.form.find("#venue_select").parent().after('<small class="help-block custom-inline-error" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+e+"</small>")):t.form.find('input[name="'+a+'"]').parent().hasClass("input-group")?(t.form.find('input[name="'+a+'"]').parent().parent().addClass("has-error"),t.form.find('input[name="'+a+'"]').parent().after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+e+"</small>"),t.form.find('input[name="'+a+'"]').parent().after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+a+'"></i>')):(t.form.find('input[name="'+a+'"]').parent().addClass("has-error"),t.form.find('input[name="'+a+'"]').parent().find(".glyphicon").remove(),t.form.find('input[name="'+a+'"]').parent().find(".help-block:visible").remove(),t.form.find('input[name="'+a+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+e+"</small>"),t.form.find('input[name="'+a+'"]').after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+a+'"></i>'))})}};
function UpdateSessions(t){this.form=t,this.saveOnly=!1,self.data="",this.init()}UpdateSessions.prototype={constructor:UpdateSessions,init:function(){this.addListeners()},addListeners:function(){$(document).on("click","#save",$.proxy(this.justSave,this)),$(document).on("submit","#update-sessions",$.proxy(this.submitUpdate,this)),$(document).on("click","#more-sessions",$.proxy(this.scrollToCalendar,this))},justSave:function(t){t.preventDefault(),this.saveOnly=!0,this.form.find('input[name="preview"]').val("no"),$("#update-sessions").trigger("submit")},submitUpdate:function(t){t.preventDefault(),this.ajaxUpload()},ajaxUpload:function(){var t=this;t.data=t.form.serialize(),$.ajax(t.form.attr("action"),{type:"post",data:t.data,dataType:"json",beforeSend:function(){t.form.find("input[type='submit']").prop("disabled",!0).append('<span id="sessionupdate-loading" class="icon icon-loading ml10 mt10"></span>')},success:function(e){0==t.saveOnly?window.location.href=e.url:($("body").append(e.view),t.saveOnly=!1,t.form.find('input[name="preview"]').val("yes"))},error:function(){console.log("error")},complete:function(){t.form.find("input[type='submit']").prop("disabled",!1),$("#sessionupdate-loading").remove()}})},scrollToCalendar:function(t){t.preventDefault();var e=$(t.target).attr("href");$("html, body").animate({scrollTop:$(e).offset().top-60},1e3)}};
function previewBox(t){this.box=t,this.height=this.box.height(),this.heroTop=$(".hero").css("margin-top").replace("px",""),this.init()}previewBox.prototype={constructor:previewBox,init:function(){$("#nav").css("margin-top",this.height),console.log(parseInt(this.heroTop)+parseInt(this.height)),$(".hero").css("margin-top",parseInt(this.heroTop)+parseInt(this.height))}};
function publishClass(i){this.form=i,this.addListeners()}publishClass.prototype={constructor:publishClass,addListeners:function(){this.form.on("submit",$.proxy(this.submitForm,this))},submitForm:function(i){i.preventDefault(),this.ajaxPost()},ajaxPost:function(){var i=this;$.ajax(i.form.attr("action"),{type:"post",data:i.form.serialize(),dataType:"json",beforeSend:function(){i.form.find("input[type='submit']").prop("disabled",!0).after('<span id="publish-loading" class="icon icon-loading ml10"></span>')},success:function(t){$("body").append(t.view),console.log(t.state),1==t.state?(i.form.find("input[type='submit']").val("Un-publish"),i.form.find("input[name='publish']").val(0)):(i.form.find("input[type='submit']").val("Publish"),i.form.find("input[name='publish']").val(1))},error:function(i,t,s){console.log(i+" - "+t+" - "+s)},complete:function(){i.form.find("input[type='submit']").prop("disabled",!1),$("#publish-loading").remove()}})}};
function facebookRedirect(t){this.btn=t,this.url=t.attr("href"),this.redirect="",this.addListeners()}facebookRedirect.prototype={constructor:facebookRedirect,addListeners:function(){$('input[name="trainer"]').on("change",$.proxy(this.changeFbUrl,this))},changeFbUrl:function(t){var e=$(t.target).val();"yes"==e?(this.redirect="trainers.create",$('input[name="phone"]').length>0&&$("label[for='phone']").find("small").text("(For Evercise to contact you)")):(this.redirect="",$('input[name="phone"]').length>0&&$("label[for='phone']").find("small").text("(Get alerts about your classes)")),this.btn.attr("href",this.url+this.redirect)}};
function voucher(t){this.elem=t,this.form=this.elem.find("form"),this.addListeners()}voucher.prototype={constructor:voucher,addListeners:function(){$("#have-voucher").on("click",$.proxy(this.haveVoucher,this)),this.form.on("submit",$.proxy(this.submit,this))},haveVoucher:function(t){$(t.target).hasClass("active")?($(t.target).removeClass("active"),$("#have-voucher-block").addClass("hidden")):($(t.target).addClass("active"),$("#have-voucher-block").removeClass("hidden"))},submit:function(t){t.preventDefault(),this.ajaxSubmit()},ajaxSubmit:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find('input[type="submit"]').prop("disabled",!0)},success:function(e){e.success?location.reload():t.elem.after('<div class="mt10 alert alert-danger alert-dismissible fixed" role="alert">your voucher is not correct<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span></button></div>')},error:function(t,e,o){console.log(t+" - "+e+" - "+o)},complete:function(){t.form.find('input[type="submit"]').prop("disabled",!1)}})}};
function AddSessionsToCalendar(t){this.form=t,this.calendar=this.form.find("#calendar"),this.index="",this.dates=[],this.selectedDates=[],this.submitDates=[],this.currentMonthYear=[],this.init()}AddSessionsToCalendar.prototype={constructor:AddSessionsToCalendar,init:function(){this.calendar.datepicker({format:"yyyy-mm-dd",startDate:"+1d",todayHighlight:!0,multidate:!0}).on("changeDate",$.proxy(this.getCurrentDates,this)),this.addListener()},addListener:function(){$(document).on("click",".dow",$.proxy(this.dayOfWeek,this)),this.form.on("submit",$.proxy(this.submitForm,this))},getCurrentDates:function(t){var e=this;this.selectedDates=t.dates,this.dates=[],$.each(this.selectedDates,function(t,s){e.dates.push({key:s.valueOf(),dates:s})})},dayOfWeek:function(t){this.currentMonthYear=$(".datepicker-switch").first().text().split(" ");var e=new Date,s=this.getMonthNumber(this.currentMonthYear[0],this.currentMonthYear[1]),a=this.currentMonthYear[1],n=this;for(this.index=$(t.target).index(),e.setDate(1),e.setMonth(s),e.setFullYear(a);e.getDay()!==this.index;)e.setDate(e.getDate()+1);for(;e.getMonth()===s;){var i=new Date(e.getUTCFullYear()+"-"+("0"+(e.getUTCMonth()+1)).slice(-2)+"-"+("0"+e.getUTCDate()).slice(-2)),r=$.grep(n.dates,function(t){return t.key==i.valueOf()}),o=$.grep(n.dates,function(t){return t.key==i.valueOf()-36e5});0==r.length&&0==o.length?n.dates.push({key:i.valueOf(),dates:i}):n.dates=n.dates.filter(function(t){return t.key!==i.valueOf()}),e.setDate(e.getDate()+7)}this.setCalendarDates()},setCalendarDates:function(){var t=[],e={};$.each(this.dates,function(s,a){e[a.key]||(e[a.key]=!0,t.push(a.dates))}),this.calendar.datepicker("setDates",t)},getMonthNumber:function(t,e){var s=Date.parse(t+"1, "+e);return isNaN(s)?-1:new Date(s).getMonth()},submitForm:function(t){t.preventDefault();var e=this;$.each(this.calendar.datepicker("getDates"),function(t,s){var a=s.getDate(),n=s.getMonth()+1,i=s.getFullYear();e.submitDates.push(i+"-"+n+"-"+a)}),$('input[name="session_array"]').val(this.submitDates),this.ajaxUpload()},ajaxUpload:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find("input[type='submit']").prop("disabled",!0).parent().after('<span id="session-loading" class="icon icon-loading ml10 mt10"></span>')},success:function(e){$("#update-session").html(e.view),$('input[name="recurring"][value="no"]').click(),t.dates=[],t.submitDates=[],t.selectedDates=[],t.setCalendarDates(),$("html, body").animate({scrollTop:$("#update-container").offset().top-20},1e3),0==RemoveSession.length&&new RemoveSession($(".remove-session"))},error:function(){console.log("error")},complete:function(){t.form.find("input[type='submit']").prop("disabled",!1),$("#session-loading").remove()}})}};
function registerUser(a){this.form=a,this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.displayName={message:"Your username is not valid",validators:{notEmpty:{message:"Your display name is required"},stringLength:{min:5,max:20,message:"Your display name must be more than 5 and less than 20 characters long"},regexp:{regexp:/^[a-zA-Z0-9_]+$/,message:"Your display name can only consist of alphabetical, number and underscore"}}},this.email={validators:{notEmpty:{message:"Your email is required and cannot be empty"},emailAddress:{message:"Your email is not a valid email address"}}},this.first_name={validators:{notEmpty:{message:"Your first name is required and cannot be empty"},stringLength:{min:2,max:15,message:"Your first name must be more than 2 and less than 15 characters long"}}},this.last_name={validators:{notEmpty:{message:"Your surname is required and cannot be empty"},stringLength:{min:2,max:15,message:"Your surname must be more than 2 and less than 15 characters long"}}},this.password={validators:{notEmpty:{message:"Your password is required and cannot be empty"},stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"confirmed_password",message:"Your passwords do not match"}}},this.confirmed_password={validators:{notEmpty:{message:"Your password is required and cannot be empty"},stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"password",message:"Your passwords do not match"}}},this.init()}registerUser.prototype={constructor:registerUser,init:function(){this.form.find("input[type='submit']").prop("disabled",!0),this.validation(),this.addListeners()},addListeners:function(){this.form.find('input[name="terms"]').on("change",$.proxy(this.reVal,this))},reVal:function(a){$(a.target).is(":checked")&&this.form.data("bootstrapValidator").isValid()&&this.form.find("input[type='submit']").prop("disabled",!1)},validation:function(){var a=this;this.form.bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{display_name:this.displayName,email:this.email,first_name:this.first_name,last_name:this.last_name,password:this.password,confirmed_password:this.confirmed_password}}).on("success.form.bv",function(e){e.preventDefault(),a.form.find('input[name="terms"]').is(":checked")||0==a.form.find('input[name="terms"]').length?a.ajaxUpload():a.form.find('input[name="terms"]').parent().append('<span class="center-block text-danger help-box">You must accept our terms and conditions before continuing</span>')})},ajaxUpload:function(){var a=this;$.ajax(a.form.attr("action"),{type:"post",data:a.form.serialize(),dataType:"json",beforeSend:function(){a.form.find("input[type='submit']").prop("disabled",!0).after('<br><span id="register-loading" class="icon icon-loading ml10"></span>')},success:function(e){1==e.validation_failed?a.failedValidation(e):window.location.href=e.url},error:function(a,e,s){console.log(a+" - "+e+" - "+s)},complete:function(){a.form.find("input[type=submit]").prop("disabled",!1),$("#register-loading").remove()}})},failedValidation:function(a){self=this;var e=a.errors;$.each(e,function(a,e){self.form.find('input[name="'+a+'"]').parent().hasClass("input-group")?(self.form.find('input[name="'+a+'"]').parent().parent().addClass("has-error"),self.form.find('input[name="'+a+'"]').parent().after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+e+"</small>"),self.form.find('input[name="'+a+'"]').parent().after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+a+'"></i>')):(self.form.find('input[name="'+a+'"]').parent().addClass("has-error"),self.form.find('input[name="'+a+'"]').parent().find(".glyphicon").remove(),self.form.find('input[name="'+a+'"]').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+a+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+e+"</small>"),self.form.find('input[name="'+a+'"]').after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+a+'"></i>'))})}};
var Profile=function(t){this.nav=t,this.top=0,this.speed=400,this.init()};Profile.prototype={constructor:Profile,init:function(){this.top=Math.floor(this.nav.offset().top-this.nav.outerHeight(!0));var t=this;$(document).on("click",".nav-pills li a",function(){destination=$(this).attr("href"),$(".nav-pills li").removeClass("active"),$(this).parent().addClass("active"),$(".profile-panels").addClass("hidden"),$(destination).removeClass("hidden"),new Masonry($(".masonry")),t.scroll()})},scroll:function(){}};
function registerTrainer(i){this.form=i,this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.profession={message:"Your profession is not valid",validators:{notEmpty:{message:"You must add a profession"},stringLength:{min:2,max:50,message:"Your profession must be more than 2 and less than 50 characters long"}}},this.bio={message:"Your bio is not valid",validators:{notEmpty:{message:"You must add a bio"},stringLength:{min:50,max:500,message:"Your bio must be more than 50 and less than 500 characters long"}}},this.init()}registerTrainer.prototype={constructor:registerTrainer,init:function(){this.form.find("input[type='submit']").prop("disabled",!0),this.addListeners(),this.validation()},addListeners:function(){$('input[name="image"]').on("change",$.proxy(this.closeAlert,this))},validation:function(){var i=this;this.form.bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{profession:this.profession,bio:this.bio}}).on("success.form.bv",function(e){e.preventDefault(),i.closeAlert(),i.checkImage()})},checkImage:function(){$('input[name="image"]').val()?this.ajaxUpload():($("html, body").animate({scrollTop:$("#image-select").offset().top},200),$(".img-uploader").after('<div class="alert alert-danger alert-dismissible fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>You must upload i profile image</div>'),this.form.find("input[type='submit']").prop("disabled",!1))},closeAlert:function(){$(".close").trigger("click")},ajaxUpload:function(){var i=this;$.ajax(i.form.attr("action"),{type:"post",data:i.form.serialize(),dataType:"json",beforeSend:function(){i.form.find("input[type='submit']").prop("disabled",!0).after('<span id="register-loading" class="icon icon-loading ml10"></span>')},success:function(e){1==e.validation_failed?i.failedValidation(e):window.location.href=e.url},error:function(i,e,a){console.log(i+" - "+e+" - "+a)},complete:function(){i.form.find("input[type=submit]").prop("disabled",!1),$("#register-loading").remove()}})},failedValidation:function(i){self=this;var e=i.errors;$.each(e,function(i,e){self.form.find('input[name="'+i+'"]').parent().addClass("has-error"),self.form.find('input[name="'+i+'"]').parent().find(".glyphicon").remove(),self.form.find('input[name="'+i+'"]').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+i+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+i+'" data-bv-result="INVALID">'+e+"</small>"),self.form.find('input[name="'+i+'"]').after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+i+'"></i>')})}};
function scrollTo(t){this.nav=t,this.target="",this.top=$("#nav").outerHeight(),this.addListeners()}scrollTo.prototype={constructor:scrollTo,addListeners:function(){this.nav.find('a[target!="_blank"]').on("click",$.proxy(this.scroll,this))},scroll:function(t){t.preventDefault(),this.target=$(t.target).attr("href"),$("html, body").animate({scrollTop:$(this.target).offset().top-this.top},300)}};
function profileNav(t){this.nav=t,this.scroll=0,this.top=$("#nav").height(),this.stickyTop=this.nav.offset().top-this.nav.height(),this.url=document.URL,this.lastOfUrl="",this.init(),this.addListeners()}profileNav.prototype={constructor:profileNav,init:function(){new Masonry($(".masonry"))},addListeners:function(){$(window).scroll($.proxy(this.checkScrollPosition,this)),$(window).on("popstate",$.proxy(this.checkHistoryState,this)),this.nav.find("a").on("click",$.proxy(this.changeTabs,this))},checkScrollPosition:function(t){this.scroll=$(t.target).scrollTop(),this.scroll>this.stickyTop?this.addStickyClass():this.removeStickyClass()},checkHistoryState:function(t){"popstate"==t.type&&(this.getUrl(),$(".nav-pills li").removeClass("active"),$('a[href="#'+this.lastOfUrl+'"]').parent().addClass("active"),$(".profile-panels").addClass("hidden"),$("#"+this.lastOfUrl).removeClass("hidden"),new Masonry($(".masonry")))},addStickyClass:function(){this.nav.addClass("navbar-fixed-top"),this.nav.css({top:this.top}),$(".profile-panels").css({"margin-top":this.nav.outerHeight(!0)})},removeStickyClass:function(){this.nav.removeClass("navbar-fixed-top"),this.nav.css({top:0}),$(".profile-panels").css({"margin-top":0})},changeTabs:function(t){t.preventDefault();var s=$(t.target).attr("href").substring(1);$(".nav-pills li").removeClass("active"),$(t.target).parent().addClass("active"),$(".profile-panels").addClass("hidden"),$("#"+s).removeClass("hidden"),this.getUrl(),this.nav.data("name")==this.lastOfUrl?window.history.pushState(null,this.lastOfUrl+"/"+s,this.lastOfUrl+"/"+s):window.history.pushState(null,s,s),new Masonry($(".masonry"))},getUrl:function(){var t=window.location.pathname,s=t.split("/");s.reverse(),this.lastOfUrl=""!=s[0]?s[0]:s[1]}};
function RateIt(t){this.block=t,this.currentBlock="",this.form="",this.hoverNth=null,this.selectedNth=null,this.stars=0,this.emptyClass="icon-empty-star",this.selectedClass="icon-full-star",this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.feedback_text={message:"Your must rate this class out of 5",validators:{notEmpty:{message:"We need to know your thoughts on this class before you rate it"}}},this.init()}RateIt.prototype={constructor:RateIt,init:function(){this.block.find("input[type='submit']").prop("disabled",!0),this.addListeners(),this.validation()},addListeners:function(){this.block.find("span.icon").not(".selected").hover($.proxy(this.hoverState,this)),this.block.find("span.icon").on("click",$.proxy(this.selectRating,this)),this.block.find("textarea").on("focus",$.proxy(this.focusTextArea,this))},hoverState:function(t){this.currentBlock=$(t.target).closest(".rate-it"),this.hoverNth="mouseenter"==t.type?$(t.target).index():null,this.changeClassOnHover()},changeClassOnHover:function(){if(null!=this.hoverNth)for(var t=0;t<=this.hoverNth;t++)this.currentBlock.find("span.icon").eq(t).removeClass(this.emptyClass).addClass(this.selectedClass);else this.currentBlock.find("span.icon").not(".selected").removeClass(this.selectedClass).addClass(this.emptyClass)},selectRating:function(t){this.currentBlock=$(t.target).closest(".rate-it"),this.currentBlock.find(".alert").remove();var s=this;setTimeout(function(){s.currentBlock.find('textarea[name="feedback_text"]').focus()},1),this.selectedNth=$(t.target).index(),this.stars=this.selectedNth+1,this.currentBlock.find("span.icon").removeClass(this.selectedClass).removeClass("selected").addClass(this.emptyClass);for(var e=0;e<=this.selectedNth;e++)this.currentBlock.find("span.icon").eq(e).removeClass(this.emptyClass).addClass(this.selectedClass).addClass("selected");this.currentBlock.find('input[name="stars"]').val(this.stars)},focusTextArea:function(t){this.currentBlock=$(t.target).closest(".rate-it"),this.currentBlock.find(".alert").remove(),$(t.target).val()&&this.currentBlock.find("input[type='submit']").prop("disabled",!1)},validation:function(){var t=this;this.block.find("form").bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{feedback_text:this.feedback_text}}).on("success.form.bv",function(s){s.preventDefault(),t.form=$(s.target),t.currentBlock=t.form.closest(".rate-it"),t.currentBlock.find(".alert").remove(),t.ratingCheck()})},ratingCheck:function(){this.form.find('input[name="stars"]').val()?this.ajaxUpload():(this.currentBlock.find("span.icon").css({transform:"rotate(360deg)",WebkitTransition:"transform 1s ease-in-out",MozTransition:"transform 1s ease-in-out",MsTransition:"transform 1s ease-in-out",OTransition:"transform 1s ease-in-out",transition:"transform 1s ease-in-out"}),this.form.append('<div class="alert alert-danger alert-dismissible fade in absolute alert-sm" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>You must add your star rating</div>'))},ajaxUpload:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find("input[type='submit']").prop("disabled",!0).after('<span id="rating-loading" class="icon icon-loading ml10"></span>')},success:function(s){1==s.validation_failed?t.failedValidation(s):window.location.href=s.url},error:function(t,s,e){console.log(t+" - "+s+" - "+e)},complete:function(){t.form.find("input[type=submit]").prop("disabled",!1),$("#rating-loading").remove()}})},failedValidation:function(t){self=this;var s=t.errors;$.each(s,function(t,s){self.form.find('input[name="'+t+'"]').parent().addClass("has-error"),self.form.find('input[name="'+t+'"]').parent().find(".glyphicon").remove(),self.form.find('input[name="'+t+'"]').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+t+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+t+'" data-bv-result="INVALID">'+s+"</small>")})}};
function LocationAutoComplete(t){this.input=t,this.autoCompleteStarted=!1,this.addScript=!1,this.mapOptions={},this.init()}LocationAutoComplete.prototype={constructor:LocationAutoComplete,init:function(){var t=this;if("undefined"!=typeof angular)window.google?this.load():setTimeout(function(){t.init()},500);else{if(!t.addScript){var o=document.createElement("script");o.src="//maps.googleapis.com/maps/api/js?libraries=places&callback=autocomplete.load",o.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(o),t.addScript=!0}setTimeout(function(){t.init()},500)}},load:function(){if(void 0==google.maps||this.autoCompleteStarted){var t=this;setTimeout(function(){t.load()},500)}else{this.autoCompleteStarted=!0;var o=new google.maps.LatLng(54.8,-4.6);this.mapOptions={zoom:5,center:o,mapTypeControl:!1,panControl:!1,zoomControl:!1,streetViewControl:!1,componentRestrictions:{country:"uk"}};{var t=this;new google.maps.places.Autocomplete(document.getElementById(t.input.attr("id")),this.mapOptions)}}}};
function topUp(t){this.form=t,this.amount=0,this.payAmount=0,this.stripe={},this.init()}topUp.prototype={constructor:topUp,init:function(){$("#stripe-button").prop("disabled",!0),$("#fb-pay").addClass("disabled"),this.addListeners()},addListeners:function(){this.form.find(".add-btn").on("click",$.proxy(this.topUpAmount,this)),this.form.find('input[name="custom"]').on("keyup change",$.proxy(this.topUpAmount,this)),this.form.find("#cancel-btn").on("click",$.proxy(this.cancelTopUp,this)),this.form.find('input[name="amount"]').on("change",$.proxy(this.amountChanged,this)),this.form.find("#stripe-button").on("click",$.proxy(this.openStripe,this)),$(window).on("popstate",$.proxy(this.closeStripe,this)),this.form.on("submit",$.proxy(this.submitForm,this))},topUpAmount:function(t){t.preventDefault(),this.amount=$(t.target).val()?$(t.target).val():$(t.target).data("amount"),this.form.find(".add-btn").removeClass("btn-primary"),this.form.find('input[name="custom"]').removeClass("btn-primary"),$(t.target).addClass("btn-primary"),this.updateAmountInput()},cancelTopUp:function(t){t.preventDefault(),this.amount=0,this.form.find(".add-btn").removeClass("btn-primary"),this.form.find('input[name="custom"]').removeClass("btn-primary"),this.updateAmountInput()},updateAmountInput:function(){this.form.find('input[name="amount"]').val(this.amount).trigger("change")},amountChanged:function(){if($("#stripe-button").prop("disabled",!0),$("#fb-pay").addClass("disabled"),this.amount>0){var t=this.amount,n=this;setTimeout(function(){var o=n.amount;t==o&&n.form.trigger("submit")},1e3)}},openStripe:function(t){var n=this;handler.open({name:"Evercise",description:"Top up",amount:n.payAmount}),t.preventDefault()},closeStripe:function(){handler.close()},submitForm:function(t){t.preventDefault(),this.ajaxUpload()},ajaxUpload:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find(".add-btn").prop("disabled",!0),t.form.find('input[name="custom"]').prop("disabled",!0)},success:function(n){$("#stripe-button").prop("disabled",!1),$("#fb-pay").removeClass("disabled"),t.payAmount=n.amount},error:function(t,n,o){console.log(t+" - "+n+" - "+o)},complete:function(){t.form.find(".add-btn").prop("disabled",!1),t.form.find('input[name="custom"]').prop("disabled",!1)}})}};
function checkout(e){this.checkout=e,this.viewPrice=viewPrice,this.addListeners()}checkout.prototype={construstor:checkout,addListeners:function(){this.checkout.find("#stripe-button").on("click",$.proxy(this.openStripe,this)),$(window).on("popstate",$.proxy(this.closeStripe,this))},openStripe:function(e){var t=this;handler.open({name:"Evercise",description:"Checkout",amount:t.viewPrice}),e.preventDefault()},closeStripe:function(){handler.close()}};
function Referral(e){this.form=e,this.addListeners()}Referral.prototype={constructor:Referral,addListeners:function(){this.form.on("submit",$.proxy(this.submitForm,this)),this.form.find("input[name='referee_email']").on("keydown",$.proxy(this.emailChange,this))},emailChange:function(e){$(e.target).parent().addClass("has-error")&&($(e.target).parent().removeClass("has-error"),this.form.find("#validation-error-text").remove(),this.form.find("#validation-error-icon").remove())},submitForm:function(e){e.preventDefault(),this.ajaxSubmit()},ajaxSubmit:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){e.emailChange(e.form.find("input[name='referee_email']")),e.form.find("input[type='submit']").prop("disabled",!0)},success:function(r){1==r.validation_failed?e.failedValidation(r):(e.form.after(r.view),$("#referral-amount").text(r.referral))},error:function(e,r,a){console.log(e+" - "+r+" - "+a)},complete:function(){e.form.find("input[type=submit]").prop("disabled",!1)}})},failedValidation:function(e){self=this;var r=e.errors;$.each(r,function(e,r){self.form.find('input[name="'+e+'"]').parent().addClass("has-error"),self.form.find('input[name="'+e+'"]').after('<small id="validation-error-text" class="help-block" data-bv-validator="notEmpty" data-bv-for="'+e+'" data-bv-result="INVALID">'+r+"</small>"),self.form.find('input[name="'+e+'"]').after('<i id="validation-error-icon" class="form-control-feedback bv-no-label glyphicon glyphicon-remove" data-bv-icon-for="'+e+'"></i>')})}};
function EditClass(e){this.form=e,this.addListeners()}EditClass.prototype={constructor:EditClass,addListeners:function(){this.form.on("submit",$.proxy(this.submit,this))},submit:function(e){e.preventDefault(),this.form=$(e.target),this.ajax()},ajax:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){e.form.find("input[type='submit']").prop("disabled",!0),e.form.find(".btn-toggle-down").prop("disabled",!0).addClass("loading")},success:function(t){e.edit(t)},error:function(e,t,i){console.log(e+" - "+t+" - "+i)},complete:function(){e.form.find("input[type='submit']").prop("disabled",!1)}})},edit:function(e){$("#"+e.id).html(e.view),$("#edit-"+e.id).removeClass("disabled"),$("#submit-"+e.id).hide(),$("#"+e.id).parent().collapse("show"),$("#infoToggle-"+e.id).removeClass("hide"),datepick(),new UpdateSession($(".update-session")),new RemoveSession($(".remove-session")),new GetMembers($(".get-members"))}};
var Masonry=function(n){this.masonry=n,this.init()};Masonry.prototype={constructor:Masonry,init:function(){var n=this.masonry;n.masonry({itemSelector:".masonry-item",isInitLayout:!0,transitionDuration:0}),n.masonry}};
function updateProfile(a){this.form=a,this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.email={validators:{notEmpty:{message:"Your email is required and cannot be empty"},emailAddress:{message:"Your email is not a valid email address"}}},this.first_name={validators:{stringLength:{min:2,max:15,message:"Your first name must be more than 2 and less than 15 characters long"}}},this.last_name={validators:{stringLength:{min:2,max:15,message:"Your surname must be more than 2 and less than 15 characters long"}}},this.password={validators:{stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"confirmed_password",message:"Your passwords do not match"}}},this.confirmed_password={validators:{stringLength:{min:6,max:32,message:"Your Password must be more than 6 and less than 32 characters long"},identical:{field:"password",message:"Your passwords do not match"}}},this.profession={message:"Your profession is not valid",validators:{notEmpty:{message:"You must add a profession"},stringLength:{min:2,max:50,message:"Your profession must be more than 2 and less than 50 characters long"}}},this.bio={message:"Your bio is not valid",validators:{notEmpty:{message:"You must add a bio"},stringLength:{min:50,max:500,message:"Your bio must be more than 50 and less than 500 characters long"}}},this.init()}updateProfile.prototype={constructor:updateProfile,init:function(){this.validation(),this.form.find("input[type='submit']").prop("disabled",!1)},validation:function(){var a=this;this.form.bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{email:this.email,first_name:this.first_name,last_name:this.last_name,password:this.password,confirmed_password:this.confirmed_password,profession:this.profession,bio:this.bio}}).on("success.form.bv",function(s){s.preventDefault(),a.ajaxUpload()})},ajaxUpload:function(){var a=this;$.ajax(a.form.attr("action"),{type:"post",data:a.form.serialize(),dataType:"json",beforeSend:function(){a.form.find("input[type='submit']").prop("disabled",!0).after('<span id="register-loading" class="icon icon-loading ml10"></span>')},success:function(s){1==s.validation_failed?a.failedValidation(s):window.location.href=s.url},error:function(a,s,i){console.log(a+" - "+s+" - "+i)},complete:function(){a.form.find("input[type=submit]").prop("disabled",!1),$("#register-loading").remove()}})},failedValidation:function(a){self=this;var s=a.errors;$.each(s,function(a,s){self.form.find('input[name="'+a+'"],input[textarea="'+a+'"] ').parent().addClass("has-error"),self.form.find('input[name="'+a+'"],input[textarea="'+a+'"] ').parent().find(".glyphicon").remove(),self.form.find('input[name="'+a+'"],input[textarea="'+a+'"] ').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+a+'"],input[textarea="'+a+'"] ').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+a+'" data-bv-result="INVALID">'+s+"</small>"),self.form.find('input[name="'+a+'"],input[textarea="'+a+'"] ').after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+a+'"></i>')})}};
function UpdateSession(t){this.form=t,this.id="",this.addListeners()}UpdateSession.prototype={constructor:UpdateSession,addListeners:function(){$(".update-session-select").on("change",$.proxy(this.sessionChanged,this)),this.form.on("submit",$.proxy(this.submit,this))},sessionChanged:function(t){var i=$(t.target).attr("form");this.form=$("#"+i),this.id=this.form.find('input[name="id"]').val(),console.log("id"+this.id),this.form.trigger("submit")},submit:function(t){t.preventDefault(),this.form=$(t.target),this.ajax()},ajax:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find("input[type='submit']").prop("disabled",!0),$("#hub-edit-row-"+t.id).addClass("bg-info")},success:function(i){t.update(i)},error:function(t,i,s){console.log(t+" - "+i+" - "+s)},complete:function(){t.form.find("input[type='submit']").prop("disabled",!1),$("#hub-edit-row-"+t.id).removeClass("bg-info")}})},update:function(t){$("#hub-edit-row-"+t.id).after(t.view)}};
function RemoveSession(t){this.form=t,this.id="",this.addListeners()}RemoveSession.prototype={constructor:RemoveSession,addListeners:function(){this.form.on("submit",$.proxy(this.submit,this))},submit:function(t){t.preventDefault(),this.form=$(t.target),this.id=this.form.find('input[name="id"]').val(),this.ajax()},ajax:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find("input[type='submit']").prop("disabled",!0),$("#hub-edit-row-"+t.id).addClass("bg-danger")},success:function(i){t.remove(i)},error:function(t,i,o){console.log(t+" - "+i+" - "+o)},complete:function(){t.form.find("input[type='submit']").prop("disabled",!1),$("#hub-edit-row-"+t.id).removeClass("bg-info")}})},remove:function(t){$("#hub-edit-row-"+t.id).fadeOut(400)}};
function listAccordion(t){this.accordion=t,this.addListeners()}listAccordion.prototype={constructor:listAccordion,addListeners:function(){this.accordion.on("shown.bs.collapse",function(t){var o=$(t.target).attr("id");$('a[href="#'+o+'"]').parent().addClass("active")}),this.accordion.on("hidden.bs.collapse",function(t){var o=$(t.target).attr("id");$('a[href="#'+o+'"]').parent().removeClass("active")})}};
function Login(t){this.form=t,this.addListeners()}Login.prototype={constructor:Login,addListeners:function(){this.form.on("submit",$.proxy(this.submit,this)),this.form.find("input").on("input",$.proxy(this.removeError,this))},removeError:function(){this.form.find(".alert").remove()},submit:function(t){t.preventDefault(),this.form=$(t.target),this.ajax()},ajax:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find("input[type='submit']").prop("disabled",!0),t.removeError()},success:function(i){1==i.validation_failed?t.failedValidation(i):window.location.href=i.url},error:function(t,i,o){console.log(t+" - "+i+" - "+o)},complete:function(){t.form.find("input[type='submit']").prop("disabled",!1)}})},failedValidation:function(t){self=this;var i=t.errors;self.form.find("input[name = 'password']").after('<div class="mt10 alert alert-danger alert-dismissible" role="alert">'+i+'<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div>')}};
function MailPopup(i){this.link=i,this.target="",this.form="",this.id="",this.validIcon="glyphicon glyphicon-ok",this.invalidIcon="glyphicon glyphicon-remove",this.validatingIcon="glyphicon glyphicon-refresh",this.subject={validators:{notEmpty:{message:"Your message requires a subject"}}},this.body={validators:{notEmpty:{message:"Your message requires content"}}},this.addListener()}MailPopup.prototype={constructor:MailPopup,addListener:function(){$(document).on("click",".mail-popup",$.proxy(this.getPopup,this))},getPopup:function(i){i.preventDefault(),this.link=$(i.target),this.id=this.link.data("id"),this.target=$(i.target).attr("href"),this.link.addClass("icon-loading"),this.ajaxGet()},ajaxGet:function(){var i=this;$.get(this.target,function(t){i.link.after(t.view),$("#mail-trainer-"+i.id).modal("show"),i.link.replaceWith('<a  href="#mail-trainer-'+i.id+'" class="icon icon-mail ml10 mt25" data-toggle="modal" data-target="#mail-trainer-'+i.id+'"></a>'),i.form=$("#mail_trainer"),i.validation()}).fail(function(){alert("error")}).always(function(){i.link.removeClass("icon-loading")})},validation:function(){var i=this;this.form.bootstrapValidator({message:"This value is not valid",feedbackIcons:{valid:this.validIcon,invalid:this.invalidIcon,validating:this.validatingIcon},fields:{mail_subject:this.subject,mail_body:this.body}}).on("success.form.bv",function(t){t.preventDefault(),i.ajaxUpload()})},ajaxUpload:function(){var i=this;$.ajax(i.form.attr("action"),{type:"post",data:i.form.serialize(),dataType:"json",beforeSend:function(){i.form.find("input[type='submit']").prop("disabled",!0).after('<span id="sending-loading" class="icon icon-loading ml10 mt15"></span>')},success:function(){i.form.find("input[type='submit']").before('<strong class="text-primary">Message sent successfully!</strong><br>'),setTimeout(function(){$(".modal").modal("hide")},1500)},error:function(i,t,a){console.log(i+" - "+t+" - "+a)},complete:function(){i.form.find("input[type=submit]").prop("disabled",!1),$("#sending-loading").remove()}})}};
function GetMembers(e){this.form=e,this.addListeners()}GetMembers.prototype={constructor:GetMembers,addListeners:function(){this.form.on("submit",$.proxy(this.submit,this))},submit:function(e){e.preventDefault(),this.form=$(e.target);var t=this.form.find('input[name="session_id"]').val();this.form.find('input[type="submit"]').replaceWith('<a  href="#session-members-'+t+'" class="icon icon-people mr15 hover" data-toggle="modal" data-target="#session-members-'+t+'"></a>'),this.ajax()},ajax:function(){var e=this;$.ajax(e.form.attr("action"),{type:"post",data:e.form.serialize(),dataType:"json",beforeSend:function(){e.form.find(".icon-people").addClass("disabled")},success:function(t){e.form.append(t.view),e.form.find(".modal").modal("show")},error:function(e,t,o){console.log(e+" - "+t+" - "+o)},complete:function(){e.form.find(".icon-people").removeClass("disabled")}})}};
function Withdrawal(t){this.form=t,this.modal="",this.addListeners()}Withdrawal.prototype={constructor:Withdrawal,addListeners:function(){this.form.on("submit",$.proxy(this.submit,this)),$(document).on("submit","#request-withdrawal-form",$.proxy(this.submit,this)),$(document).on("input",'input[name="paypal"]',$.proxy(this.removeValidation,this)),$(document).on("input",'input[name="amount"]',$.proxy(this.removeValidation,this))},submit:function(t){t.preventDefault(),this.form=$(t.target),this.ajax()},ajax:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find('input[type="submit"]').prop("disabled",!0)},success:function(a){a.view?($("body").append(a.view),t.form.find('input[type="submit"]').replaceWith('<a  href="#request-withdrawal" class="btn btn-default" data-toggle="modal" data-target="#request-withdrawal">Request Funds</a>'),t.modal=$("#request-withdrawal"),t.modal.modal("show")):1==a.validation_failed?t.failedValidation(a):(t.form.find('input[name="amount"]').addClass("mb40"),t.form.find('input[name="amount"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="amount" data-bv-result="VALID">Withdrawel Successful, We are now refreshing this page for you.</small>'),location.reload())},error:function(t,a,e){console.log(t+" - "+a+" - "+e)},complete:function(){t.form.find('input[type="submit"]').prop("disabled",!1)}})},removeValidation:function(t){$(t.target).parent().removeClass("has-error mb40"),$(t.target).parent().find(".help-block:visible").remove()},failedValidation:function(t){self=this;var a=t.errors;$.each(a,function(t,a){self.form.find('input[name="'+t+'"]').parent().addClass("has-error mb40"),self.form.find('input[name="'+t+'"]').parent().find(".help-block:visible").remove(),self.form.find('input[name="'+t+'"]').after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+t+'" data-bv-result="INVALID">'+a+"</small>")})}};
var ToggleSwitch=function(t){this.toggle=t,this.originalClass=t.data("removeclass"),this.switchClass=t.data("switchclass"),this.originalText=t.text(),this.switchText=t.data("switchtext"),this.init()};ToggleSwitch.prototype={constructor:ToggleSwitch,init:function(){this.toggle.text(this.switchText),this.toggle.addClass(this.switchClass),this.toggle.removeClass(this.originalClass),this.toggle.data("switchtext",this.originalText),this.toggle.data("removeclass",this.switchClass),this.toggle.data("switchclass",this.originalClass)}};
function Map(a){this.lat=a.data("lat"),this.lng=a.data("lng"),this.zoom=a.data("zoom"),this.icon="/assets/img/icon_default_small_pin.png",this.init()}Map.prototype={constructor:Map,init:function(){var a=document.createElement("script");a.src="//www.google.com/jsapi?key=AIzaSyAha5JzFciZvU_rWu_2d2UVl7o4Z8LWdcg&callback=map.load",a.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(a)},load:function(){self=this,google.load("maps","3",{other_params:"sensor=false",callback:function(){var a=new google.maps.Map(document.getElementById("map_canvas"),{center:new google.maps.LatLng(self.lat,self.lng),zoom:self.zoom,mapTypeId:google.maps.MapTypeId.ROADMAP});google.maps.event.trigger(a,"resize");var e=new google.maps.Marker({position:new google.maps.LatLng(self.lat,self.lng),animation:google.maps.Animation.DROP,icon:self.icon});e.setMap(a)}})}};
var AjaxRequest=function(t,a){this.form=t,this.actionUrl=t.attr("action"),this.method=t.attr("method"),this.data=t.serialize(),this.dataType="json",this.validationScrollSpeed=200,this.validationoffset=85,this.validationscroll=!1,this.callbackname=a,this.disableButton(),this.init()};AjaxRequest.prototype={constuctor:AjaxRequest,init:function(){self=this,$.ajax({url:self.actionUrl,type:self.method,data:self.data,dataType:self.dataType}).done(function(t){self.callbackSelctor(t)})},disableButton:function(){this.form.find('input[type="submit"]').prop("disabled",!0)},renableButton:function(){this.form.find('input[type="submit"]').prop("disabled",!1)},callbackSelctor:function(t){"error"==t.callback?self.failedValidation(t):self.callbackname(t)},failedValidation:function(t){self=this;var a=t.errors;"login-form"==self.form.attr("id")?self.form.find("input[name = 'password']").after('<div class="mt10 alert alert-danger alert-dismissible" role="alert">'+a+'<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div>'):$.each(a,function(t,a){0==self.validationscroll&&(self.form.find("#"+t).focus(),$("html, body").animate({scrollTop:self.form.find("#"+t).offset().top-self.validationoffset},self.validationScrollSpeed),self.validationscroll=!0),self.form.find("#"+t).parent().addClass("has-error"),self.form.find("#"+t).parent().find(".glyphicon").remove(),self.form.find('input[name="'+t+'"]').parent().find(".help-block:visible").remove(),self.form.find("#"+t).after('<small class="help-block" data-bv-validator="notEmpty" data-bv-for="'+t+'" data-bv-result="INVALID">'+a+"</small>"),self.form.find("#"+t).after('<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="'+t+'" style="display: block;"></i>')}),self.renableButton()}};
var ImagePlaceholder=function(){this.colour="#ebedee",this.size=0,this.themes()};ImagePlaceholder.prototype={constructor:ImagePlaceholder,themes:function(){self=this,Holder.addTheme("upload",{background:self.colour,foreground:self.colour,size:self.size})}};
var PreviewClassBox=function(s){this.box=s,this.boxClass=s.attr("class"),this.id=s.attr("id")};
function Cart(t){this.cart=t,this.form="",this.maxQty="2000",this.addListeners()}Cart.prototype={constructor:Cart,addListeners:function(){$(document).on("submit","#empty-cart",$.proxy(this.submit,this)),$(document).on("submit",".remove-row",$.proxy(this.submit,this)),$(document).on("submit",".add-to-class",$.proxy(this.submit,this)),$(document).on("change",".btn-select",$.proxy(this.changeSelectDropdown,this)),$(document).on("click",".toggle-select .switch a",$.proxy(this.switchQty,this))},changeSelectDropdown:function(t){$(t.target).val()?($(t.target).css("z-index",1),$(t.target).closest(".add-to-class").trigger("submit")):$(t.target).css("z-index",0)},switchQty:function(t){t.preventDefault(),t.stopPropagation();var a=$(t.target).closest(".toggle-select");this.maxQty=$(a).data("qty");var i=$(a).data("trigger"),s=$(t.target).attr("href").substring(1),e=$(a).find("#toggle-quantity").val();if("plus"==s){if(e<this.maxQty){var o=Math.max(parseInt(e)+1);$(a).find("#toggle-quantity").val(o),$(a).find("#qty").text(o)}}else if(e>1){var o=Math.max(parseInt(e)-1);$(a).find("#toggle-quantity").val(o),$(a).find("#qty").text(o)}i&&$(t.target).closest(".add-to-class").trigger("submit")},submit:function(t){t.preventDefault(),t.stopPropagation(),this.form=$(t.target),this.ajaxSubmit()},ajaxSubmit:function(){var t=this;$.ajax(t.form.attr("action"),{type:"post",data:t.form.serialize(),dataType:"json",beforeSend:function(){t.form.find('input[type="submit"]').hasClass("add-btn")?t.form.find("input[type='submit']").prop("disabled",!0):t.form.find("input[type='submit']").replaceWith('<span id="cart-loading" class="icon icon-loading"></span>'),t.form.find(".switch").addClass("disabled")},success:function(a){a.view?t.updateCart(a):a.refresh?location.reload():1==a.validation_failed&&t.failedValidation(a)},error:function(t,a,i){console.log(t+" - "+a+" - "+i)},complete:function(){t.form.find("input[type=submit]").prop("disabled",!1),$("#cart-loading").remove(),t.form.find(".switch").removeClass("disabled")}})},updateCart:function(t){$(".cart-dropdown:visible").addClass("open"),$(".cart-dropdown.open .dropdown-cart").replaceWith(t.view)},failedValidation:function(t){$("body").append('<div class="mt10 alert alert-danger alert-dismissible fixed" >'+t.errors.custom+'<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div>')}};
